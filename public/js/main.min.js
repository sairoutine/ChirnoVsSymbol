!function t(e,i,o){function n(s,h){if(!i[s]){if(!e[s]){var a="function"==typeof require&&require;if(!h&&a)return a(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=i[s]={exports:{}};e[s][0].call(p.exports,function(t){var i=e[s][1][t];return n(i?i:t)},p,p.exports,t,e,i,o)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({1:[function(t,e,i){"use strict";var o=t("./hakurei").core,n=t("./hakurei").util,r=t("./scene/stg"),s=t("./scene/loading"),h=function(t){o.apply(this,arguments),this.addScene("stg",new r(this)),this.addScene("loading",new s(this))};n.inherit(h,o),h.prototype.init=function(){o.prototype.init.apply(this,arguments),this.changeScene("loading")},e.exports=h},{"./hakurei":2,"./scene/loading":17,"./scene/stg":18}],2:[function(t,e,i){"use strict";e.exports=t("./hakurejs/index")},{"./hakurejs/index":6}],3:[function(t,e,i){"use strict";var o=function(t){this.images={},this.loading_image_num=0,this.loaded_image_num=0};o.prototype.init=function(){for(var t in this.images)this.images[t].src="";this.images={},this.loading_image_num=0,this.loaded_image_num=0},o.prototype.loadImage=function(t,e){var i=this;i.loading_image_num++;var o=function(){i.loaded_image_num++},n=new Image;n.src=e,n.onload=o,this.images[t]=n},o.prototype.isAllLoaded=function(){return this.loaded_image_num>0&&this.loaded_image_num===this.loading_image_num},o.prototype.getImage=function(t){return this.images[t]},e.exports=o},{}],4:[function(t,e,i){"use strict";var o={BUTTON_SHIFT:16,BUTTON_SPACE:32,BUTTON_LEFT:37,BUTTON_UP:38,BUTTON_RIGHT:39,BUTTON_DOWN:40,BUTTON_X:88,BUTTON_Z:90};e.exports=o},{}],5:[function(t,e,i){"use strict";var o=t("./constant"),n=t("./asset_loader/image"),r=function(t){this.ctx=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.current_scene=null,this.scenes={},this.frame_count=0,this.request_id=null,this.key_down_map={},this.image_loader=new n};r.prototype.init=function(){this.current_scene=null,this.frame_count=0,this.request_id=null,this.key_down_map={},this.image_loader.init()},r.prototype.isRunning=function(){return this.request_id?!0:!1},r.prototype.startRun=function(){this.isRunning()||this.run()},r.prototype.run=function(){this.handleGamePad();var t=this.currentScene();t&&(t.beforeDraw(),this.clearCanvas(),t.draw(),t.afterDraw()),this.frame_count++,this.request_id=requestAnimationFrame(this.run.bind(this))},r.prototype.currentScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},r.prototype.addScene=function(t,e){this.scenes[t]=e},r.prototype.changeScene=function(t){this.current_scene=t,this.currentScene().init()},r.prototype.clearCanvas=function(){this.ctx.clearRect(0,0,this.width,this.height)},r.prototype.handleKeyDown=function(t){var e=t.keyCode;e in this.key_down_map||(this.key_down_map[e]=0),this.key_down_map[e]++,t.preventDefault()},r.prototype.handleKeyUp=function(t){this.key_down_map[t.keyCode]=0,t.preventDefault()},r.prototype.handleGamePad=function(){var t=navigator.getGamepads(),e=t[0];if(e){for(var i=[o.BUTTON_Z,o.BUTTON_X],n=0,r=i.length;r>n;n++)e.buttons[n].pressed?(i[n]in this.key_down_map||(this.key_down_map[i[n]]=0),this.key_down_map[i[n]]++):this.key_down_map[i[n]]=0;e.axes[1]<-.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_UP]=0),this.key_down_map[o.BUTTON_UP]++):this.key_down_map[o.BUTTON_UP]=0,e.axes[1]>.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_DOWN]=0),this.key_down_map[o.BUTTON_DOWN]++):this.key_down_map[o.BUTTON_DOWN]=0,e.axes[0]<-.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_LEFT]=0),this.key_down_map[o.BUTTON_LEFT]++):this.key_down_map[o.BUTTON_LEFT]=0,e.axes[0]>.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_RIGHT]=0),this.key_down_map[o.BUTTON_RIGHT]++):this.key_down_map[o.BUTTON_RIGHT]=0}},r.prototype.isKeyDown=function(t){return this.key_down_map[t]>0?!0:!1},r.prototype.isKeyPush=function(t){return 1===this.key_down_map[t]?!0:!1},e.exports=r},{"./asset_loader/image":3,"./constant":4}],6:[function(t,e,i){"use strict";e.exports={util:t("./util"),core:t("./core"),constant:t("./constant"),scene:{base:t("./scene/base")},object:{base:t("./object/base"),sprite:t("./object/sprite"),pool_manager:t("./object/pool_manager")},asset_loader:{image:t("./asset_loader/image")}}},{"./asset_loader/image":3,"./constant":4,"./core":5,"./object/base":7,"./object/pool_manager":8,"./object/sprite":9,"./scene/base":10,"./util":11}],7:[function(t,e,i){"use strict";var o=t("../util"),n=0,r=function(t){this.scene=t,this.core=t.core,this.id=++n,this.frame_count=0,this.x=0,this.y=0,this.velocity={magnitude:0,theta:0}};r.prototype.init=function(){this.frame_count=0,this.x=0,this.y=0},r.prototype.beforeDraw=function(){this.frame_count++,this.move()},r.prototype.draw=function(){},r.prototype.afterDraw=function(){},r.prototype.move=function(){var t=o.calcMoveXByVelocity(this.velocity),e=o.calcMoveYByVelocity(this.velocity);this.x+=t,this.y+=e},r.prototype.onCollision=function(){},r.prototype.width=function(){return 0},r.prototype.height=function(){return 0},r.prototype.globalCenterX=function(){return this.scene.x+this.x},r.prototype.globalCenterY=function(){return this.scene.y+this.y},r.prototype.globalLeftX=function(){return this.scene.x+this.x-this.width()/2},r.prototype.globalRightX=function(){return this.scene.x+this.x+this.width()/2},r.prototype.globalUpY=function(){return this.scene.x+this.y-this.height()/2},r.prototype.globalDownY=function(){return this.scene.x+this.y+this.height()/2},r.prototype.collisionWidth=function(){return 0},r.prototype.collisionHeight=function(){return 0},r.prototype.checkCollisionWithObject=function(t){var e=this;return t.checkCollision(e)?(t.onCollision(e),e.onCollision(t),!0):!1},r.prototype.checkCollision=function(t){return Math.abs(this.x-t.x)<this.collisionWidth()/2+t.collisionWidth()/2&&Math.abs(this.y-t.y)<this.collisionHeight()/2+t.collisionHeight()/2?!0:!1},r.prototype.getCollisionLeftX=function(){return this.x-this.collisionWidth()/2},r.prototype.getCollisionUpY=function(){return this.y-this.collisionHeight()/2},r.prototype.setVelocity=function(t){this.velocity=t},e.exports=r},{"../util":11}],8:[function(t,e,i){"use strict";var o=t("./base"),n=t("../util"),r=function(t,e){o.apply(this,arguments),this.Class=e,this.objects={}};n.inherit(r,o),r.prototype.init=function(){o.prototype.init.apply(this,arguments),this.objects={}},r.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].beforeDraw()},r.prototype.draw=function(){o.prototype.draw.apply(this,arguments);for(var t in this.objects)this.objects[t].draw()},r.prototype.afterDraw=function(){o.prototype.afterDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].afterDraw()},r.prototype.create=function(){var t=new this.Class(this.scene);return t.init.apply(t,arguments),this.objects[t.id]=t,t},r.prototype.remove=function(t){delete this.objects[t]},r.prototype.checkCollisionWithObject=function(t){for(var e in this.objects){var i=this.objects[e];t.checkCollision(i)&&(t.onCollision(i),i.onCollision(t))}},r.prototype.checkCollisionWithManager=function(t){for(var e in this.objects)for(var i in t.objects)if(this.objects[e].checkCollision(t.objects[i])){var o=this.objects[e],n=t.objects[i];if(o.onCollision(n),n.onCollision(o),!this.objects[e])break}},e.exports=r},{"../util":11,"./base":7}],9:[function(t,e,i){"use strict";var o=t("./base"),n=t("../util"),r=function(t){o.apply(this,arguments),this.current_sprite_index=0};n.inherit(r,o),r.prototype.init=function(){o.prototype.init.apply(this,arguments),this.current_sprite_index=0},r.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments),this.frame_count%this.spriteAnimationSpan()===0&&(this.current_sprite_index++,this.current_sprite_index>=this.spriteIndices().length&&(this.current_sprite_index=0))},r.prototype.draw=function(){o.prototype.draw.apply(this,arguments);var t=this.core.image_loader.getImage(this.spriteName()),e=this.core.ctx;e.save(),e.translate(this.globalCenterX(),this.globalCenterY());var i=n.thetaToRadian(this.velocity.theta+this.rotateAdjust());e.rotate(i);var r=this.spriteWidth(),s=this.spriteHeight();r||(r=t.width),s||(s=t.height);var h=r*this.scale(),a=s*this.scale();e.drawImage(t,r*this.spriteIndexX(),s*this.spriteIndexY(),r,s,-h/2,-a/2,h,a),e.restore()},r.prototype.spriteName=function(){throw new Error("spriteName method must be overridden.")},r.prototype.spriteIndexX=function(){return this.spriteIndices()[this.current_sprite_index].x},r.prototype.spriteIndexY=function(){return this.spriteIndices()[this.current_sprite_index].y},r.prototype.spriteAnimationSpan=function(){return 0},r.prototype.spriteIndices=function(){return[{x:0,y:0}]},r.prototype.spriteWidth=function(){return 0},r.prototype.spriteHeight=function(){return 0},r.prototype.rotateAdjust=function(){return 0},r.prototype.scale=function(){return 1},e.exports=r},{"../util":11,"./base":7}],10:[function(t,e,i){"use strict";var o=function(t){this.core=t,this.width=t.width,this.height=t.height,this.x=0,this.y=0,this.frame_count=0,this.objects=[]};o.prototype.init=function(){this.x=0,this.y=0,this.frame_count=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},o.prototype.beforeDraw=function(){this.frame_count++;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw()},o.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw()},o.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},o.prototype.addObject=function(t){this.objects.push(t)},e.exports=o},{}],11:[function(t,e,i){"use strict";var o={inherit:function(t,e){var i=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=i(e.prototype),t.prototype.constructor=t},radianToTheta:function(t){return 180*t/Math.PI|0},thetaToRadian:function(t){return t*Math.PI/180},calcMoveXByVelocity:function(t){return t.magnitude*Math.cos(o.thetaToRadian(t.theta))},calcMoveYByVelocity:function(t){return t.magnitude*Math.sin(o.thetaToRadian(t.theta))},hexToRGBString:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t,i=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return"rgb("+i+", "+o+", "+n+")"}};e.exports=o},{}],12:[function(t,e,i){"use strict";var o=function(t){this.enemies=t.enemies,this.chara=t.chara,this.scene=t,this.frame_count=0};o.prototype.init=function(){this.frame_count=0},o.prototype.exec=function(){this.update(),this.is_occur()&&this.create()},o.prototype.update=function(){this.frame_count++},o.prototype.is_occur=function(){return this.frame_count%20===0},o.prototype.create=function(){for(var t=Math.floor(5*Math.random()+1),e=Math.floor(50*Math.random()),i=0;3>i;i++){var o=Math.floor(Math.random()*this.chara.x+100),n=Math.floor(Math.random()*this.chara.y+100);this.enemies.create(o,n,t,e)}},e.exports=o},{}],13:[function(t,e,i){"use strict";var o=t("./game");window.AudioContext=window.AudioContext||window.webkitAudioContext;var n;window.onload=function(){var t=document.getElementById("mainCanvas");n=new o(t),n.init(),window.onkeydown=function(t){n.handleKeyDown(t)},window.onkeyup=function(t){n.handleKeyUp(t)},n.startRun()},window.onerror=function(t,e,i,o,n){window.alert(t+"\n"+i+":"+o)}},{"./game":1}],14:[function(t,e,i){"use strict";var o=t("../hakurei").object.sprite,n=t("../hakurei").util,r=t("../hakurei").constant,s=6,h=function(t){o.apply(this,arguments),this.velocity={theta:0,magnitude:10}};n.inherit(h,o),h.prototype.init=function(){o.prototype.init.apply(this,arguments),this.x=this.scene.width/2,this.y=this.scene.height/2};var a=315,c=225,p=45,u=135,l=270,y=90,f=180,d=0;h.prototype.beforeDraw=function(){if(o.prototype.beforeDraw.apply(this,arguments),this.core.isKeyDown(r.BUTTON_LEFT)&&this.core.isKeyDown(r.BUTTON_DOWN)?this.velocity.theta=u:this.core.isKeyDown(r.BUTTON_RIGHT)&&this.core.isKeyDown(r.BUTTON_DOWN)?this.velocity.theta=p:this.core.isKeyDown(r.BUTTON_LEFT)&&this.core.isKeyDown(r.BUTTON_UP)?this.velocity.theta=c:this.core.isKeyDown(r.BUTTON_RIGHT)&&this.core.isKeyDown(r.BUTTON_UP)?this.velocity.theta=a:this.core.isKeyDown(r.BUTTON_UP)?this.velocity.theta=l:this.core.isKeyDown(r.BUTTON_DOWN)?this.velocity.theta=y:this.core.isKeyDown(r.BUTTON_LEFT)?this.velocity.theta=f:this.core.isKeyDown(r.BUTTON_RIGHT)&&(this.velocity.theta=d),this.frame_count%s===0){var t=15,e=15,i=this.velocity.theta;this.scene.shots.create(this.x,this.y,e,i),this.scene.shots.create(this.x,this.y,e,i).moveByVelocity({magnitude:t,theta:i+90}),this.scene.shots.create(this.x,this.y,e,i).moveByVelocity({magnitude:t,theta:i-90})}},h.prototype.move=function(){this.core.isKeyDown(r.BUTTON_Z)&&o.prototype.move.apply(this,arguments)},h.prototype.spriteName=function(){return"chara"},h.prototype.spriteIndices=function(){return[{x:4,y:0},{x:5,y:0}]},h.prototype.spriteAnimationSpan=function(){return 6},h.prototype.spriteWidth=function(){return 80},h.prototype.spriteHeight=function(){return 96},e.exports=h},{"../hakurei":2}],15:[function(t,e,i){"use strict";var o=t("../hakurei").object.base,n=t("../hakurei").util,r=t("../object/shot"),s=function(t){o.apply(this,arguments)};n.inherit(s,o),s.prototype.init=function(t,e,i,n){o.prototype.init.apply(this,arguments),this.hp=n;var r=["BCB6FF","B8E1FF","94FBAB","82ABA1"],s=Math.floor(Math.random()*r.length);this.color=r[s],this.type=Math.floor(3*Math.random()),this.x=t,this.y=e,this.setVelocity({magnitude:i,theta:0})},s.prototype.draw=function(){switch(o.prototype.draw.apply(this,arguments),this.type){case 0:this.drawBox();break;case 1:this.drawTriangle();break;case 2:this.drawCircle();break;default:throw new Error("unknown enemy type")}},s.prototype.drawBox=function(){var t=this.core.ctx,e=20;t.save(),t.fillStyle=n.hexToRGBString(this.color),t.translate(this.globalCenterX(),this.globalCenterY()),t.fillRect(0,0,e,e),t.restore()},s.prototype.drawTriangle=function(){var t=this.core.ctx;t.save(),t.fillStyle=n.hexToRGBString(this.color),t.translate(this.globalCenterX(),this.globalCenterY()),t.beginPath(),t.moveTo(75,50),t.lineTo(100,75),t.lineTo(100,25),t.fill(),t.restore()},s.prototype.drawCircle=function(){var t=this.core.ctx,e=20;t.save(),t.fillStyle=n.hexToRGBString(this.color),t.beginPath(),t.arc(this.globalCenterX(),this.globalCenterY(),e,0,2*Math.PI,!0),t.fill(),t.restore()},s.prototype.onCollision=function(t){t instanceof r&&(this.hp--,this.hp<=0&&this.die())},s.prototype.collisionWidth=function(){return 20},s.prototype.collisionHeight=function(){return 20},s.prototype.die=function(){this.scene.enemies.remove(this.id),this.scene.score+=100},e.exports=s},{"../hakurei":2,"../object/shot":16}],16:[function(t,e,i){"use strict";var o=t("../hakurei").object.sprite,n=t("../hakurei").util,r=function(t){o.apply(this,arguments)};n.inherit(r,o),r.prototype.init=function(t,e,i,n){o.prototype.init.apply(this,arguments),this.x=t,this.y=e,this.setVelocity({magnitude:i,theta:n})},r.prototype.moveByVelocity=function(t){var e=n.calcMoveXByVelocity(t),i=n.calcMoveYByVelocity(t);this.x+=e,this.y+=i},r.prototype.spriteName=function(){return"shot"},r.prototype.spriteIndices=function(){return[{x:5,y:13}]},r.prototype.spriteWidth=function(){return 18},r.prototype.spriteHeight=function(){return 16},r.prototype.rotateAdjust=function(){return 90},r.prototype.collisionWidth=function(){return 18},r.prototype.collisionHeight=function(){return 18},r.prototype.onCollision=function(t){this.scene.shots.remove(this.id)},e.exports=r},{"../hakurei":2}],17:[function(t,e,i){"use strict";var o=t("../hakurei").scene.base,n=t("../hakurei").util,r=function(t){o.apply(this,arguments)};n.inherit(r,o),r.prototype.init=function(){o.prototype.init.apply(this,arguments),this.core.image_loader.loadImage("chara","./image/chirno.png"),this.core.image_loader.loadImage("shot","./image/shot.png")},r.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments),this.core.image_loader.isAllLoaded()&&this.core.changeScene("stg")},r.prototype.draw=function(){o.prototype.draw.apply(this,arguments);var t=this.core.ctx;t.save(),t.fillStyle="rgb( 0, 0, 0 )",t.textAlign="right",t.font="30px 'ＭＳ ゴシック'",t.fillText("Now Loading...",400,225),t.restore()},e.exports=r},{"../hakurei":2}],18:[function(t,e,i){"use strict";var o=t("../hakurei").scene.base,n=t("../hakurei").util,r=t("../hakurei").object.pool_manager,s=t("../hakurei").constant,h=t("../object/chara"),a=t("../object/enemy"),c=t("../object/shot"),p=t("../logic/enemy_appear"),u=function(t){o.apply(this,arguments),this.width=1500,this.height=1500,this.shots=new r(this,c),this.addObject(this.shots),this.chara=new h(this),this.addObject(this.chara),this.enemies=new r(this,a),this.addObject(this.enemies),this.enemy_appear=new p(this)};n.inherit(u,o),u.prototype.init=function(){o.prototype.init.apply(this,arguments),this.enemy_appear.init(),this.x=-this.chara.x+this.core.width/2,this.y=-this.chara.y+this.core.height/2},u.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments),this.enemy_appear.exec(),this.core.isKeyDown(s.BUTTON_Z)&&(this.chara.x<0?this.chara.x=0:this.chara.x>this.width&&(this.chara.x=this.width),this.chara.y<0?this.chara.y=0:this.chara.y>this.height&&(this.chara.y=this.height),this.x=-this.chara.x+this.core.width/2,this.y=-this.chara.y+this.core.height/2),this.enemies.checkCollisionWithManager(this.shots)},u.prototype.draw=function(){var t=this.core.ctx;t.fillStyle=n.hexToRGBString("E2FFFC"),t.fillRect(0,0,this.width,this.height);var e=10;t.fillStyle=n.hexToRGBString("608C87"),t.fillRect(this.x,this.y,e,this.height),t.fillRect(this.x+e,this.y,this.width,e),t.fillRect(this.x+this.width,this.y+e,e,this.height),t.fillRect(this.x,this.y+this.height,this.width,e),o.prototype.draw.apply(this,arguments)},e.exports=u},{"../hakurei":2,"../logic/enemy_appear":12,"../object/chara":14,"../object/enemy":15,"../object/shot":16}]},{},[13]);