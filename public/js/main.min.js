!function t(e,i,r){function s(a,o){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!o&&h)return h(a,!0);if(n)return n(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){var i=e[a][1][t];return s(i?i:t)},l,l.exports,t,e,i,r)}return i[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)s(r[a]);return s}({1:[function(t,e,i){!function(t,e){function i(t,e,r,s){i._super_.call(this),this.reset(t,e,r,s)}function r(t,e,i,s){r._super_.call(this),this.x=t,this.y=e,this.width=i,this.height=s}function s(t,e){s._super_.call(this),this.x=t,this.y=e}function n(t,e,i){n._super_.call(this),this.x=t,this.y=e,this.radius=i,this.angle=0,this.center={x:this.x,y:this.y}}function a(t,e,i,r,s){a._super_.call(this),i-t>=0?(this.x1=t,this.y1=e,this.x2=i,this.y2=r):(this.x1=i,this.y1=r,this.x2=t,this.y2=e),this.dx=this.x2-this.x1,this.dy=this.y2-this.y1,this.minx=Math.min(this.x1,this.x2),this.miny=Math.min(this.y1,this.y2),this.maxx=Math.max(this.x1,this.x2),this.maxy=Math.max(this.y1,this.y2),this.dot=this.x2*this.y1-this.x1*this.y2,this.xxyy=this.dx*this.dx+this.dy*this.dy,this.gradient=this.getGradient(),this.length=this.getLength(),this.direction=Q.Util.initValue(s,">")}function o(){this.vector=new Q.Vector2D(0,0),this.random=0,this.crossType="dead",this.alert=!0}function h(t,e){h._super_.call(this,t,e),this.gl=this.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),this.gl||alert("Sorry your browser do not suppest WebGL!"),this.initVar(),this.setMaxRadius(),this.initShaders(),this.initBuffers(),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND)}function u(t,e,i){u._super_.call(this,t,e),this.context=this.element.getContext("2d"),this.imageData=null,this.rectangle=null,this.rectangle=i,this.createImageData(i)}function l(t,e){l._super_.call(this,t,e),this.stroke=null,this.context=this.element.getContext("2d"),this.bufferCache={}}function c(t,e,i){c._super_.call(this,t,e),this.stroke=i}function p(t,e){p._super_.call(this,t,e),this.stroke=null}function f(t,e,i){this.proton=t,this.element=e,this.stroke=i,this.pool=new Q.Pool}function d(t,e,i){this.element=i,this.type=Q.Util.initValue(t,"canvas"),this.proton=e,this.renderer=this.getRenderer()}function m(e,i,r){this.mouseTarget=Q.Util.initValue(e,t),this.ease=Q.Util.initValue(i,.7),this._allowEmitting=!1,this.initEventHandler(),m._super_.call(this,r)}function g(t){this.selfBehaviours=[],g._super_.call(this,t)}function y(t){this.initializes=[],this.particles=[],this.behaviours=[],this.emitTime=0,this.emitTotalTimes=-1,this.damping=.006,this.bindEmitter=!0,this.rate=new Q.Rate(1,.1),y._super_.call(this,t),this.id="emitter_"+y.ID++}function v(t,e,i,r){v._super_.call(this,i,r),this.distanceVec=new Q.Vector2D,this.centerPoint=Q.Util.initValue(t,new Q.Vector2D),this.force=Q.Util.initValue(this.normalizeValue(e),100),this.name="GravityWell"}function x(t,e,i,r){x._super_.call(this,i,r),this.reset(t,e),this.name="Color"}function b(t,e,i,r,s){b._super_.call(this,r,s),this.reset(t,e,i),this.name="Rotate"}function w(t,e,i,r){w._super_.call(this,i,r),this.reset(t,e),this.name="Scale"}function _(t,e,i,r){_._super_.call(this,i,r),this.reset(t,e),this.name="Alpha"}function E(t,e,i,r){E._super_.call(this,i,r),this.reset(t,e),this.name="CrossZone"}function U(t,e,i,r,s){U._super_.call(this,r,s),this.reset(t,e,i),this.name="Collision"}function P(t,e,i){P._super_.call(this,0,t,e,i),this.name="Gravity"}function R(t,e,i,r,s){R._super_.call(this,t,e,i,r,s),this.force*=-1,this.name="Repulsion"}function T(t,e,i,r,s){T._super_.call(this,r,s),this.reset(t,e,i),this.time=0,this.name="RandomDrift"}function I(t,e,i,r,s){I._super_.call(this,r,s),this.targetPosition=Q.Util.initValue(t,new Q.Vector2D),this.radius=Q.Util.initValue(i,1e3),this.force=Q.Util.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new Q.Vector2D,this.lengthSq=0,this.name="Attraction"}function S(t,e,i,r){S._super_.call(this,i,r),this.force=this.normalizeForce(new Q.Vector2D(t,e)),this.name="Force"}function A(t,e,i){A._super_.call(this),this.image=this.setSpanValue(t),this.w=Q.Util.initValue(e,20),this.h=Q.Util.initValue(i,this.w)}function B(t,e,i){B._super_.call(this),this.radius=Q.Util.setSpanValue(t,e,i)}function D(t,e,i){D._super_.call(this),this.massPan=Q.Util.setSpanValue(t,e,i)}function V(t,e,i){V._super_.call(this),this.rPan=Q.Util.setSpanValue(t),this.thaPan=Q.Util.setSpanValue(e),this.type=Q.Util.initValue(i,"vector")}function M(t){M._super_.call(this),this.zone=Q.Util.initValue(t,new Q.PointZone)}function C(t,e,i){C._super_.call(this),this.lifePan=Q.Util.setSpanValue(t,e,i)}function O(){}function L(t,e){this.numPan=Q.Util.initValue(t,1),this.timePan=Q.Util.initValue(e,1),this.numPan=Q.Util.setSpanValue(this.numPan),this.timePan=Q.Util.setSpanValue(this.timePan),this.startTime=0,this.nextTime=0,this.init()}function k(t,e){this.id="Behaviour_"+k.id++,this.life=Q.Util.initValue(t,1/0),this.easing=Q.ease.setEasingByName(e),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.name="Behaviour"}function F(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r,this.bottom=this.y+this.height,this.right=this.x+this.width}function z(t){Q.Util.isArray(t)?this.colorArr=t:this.colorArr=[t]}function j(t,e,i){this.isArray=!1,Q.Util.isArray(t)?(this.isArray=!0,this.a=t):(this.a=Q.Util.initValue(t,1),this.b=Q.Util.initValue(e,this.a),this.center=Q.Util.initValue(i,!1))}function G(){this.cID=0,this.list={}}function q(t){this.id="particle_"+q.ID++,this.reset(!0),Q.Util.setPrototypeByObject(this,t)}function N(){this.mats=[],this.size=0;for(var t=0;20>t;t++)this.mats.push(Q.Mat3.create([0,0,0,0,0,0,0,0,0]))}function W(){this.initialize()}function Q(t,e){this.integrationType=Q.Util.initValue(e,Q.EULER),this.emitters=[],this.renderers=[],this.time=0,this.oldTime=0,Q.pool=new Q.Pool(100),Q.integrator=new Q.NumericalIntegration(this.integrationType)}Q.POOL_MAX=1e3,Q.TIME_STEP=60,Q.USE_CLOCK=!1,Q.MEASURE=100,Q.EULER="euler",Q.RK2="runge-kutta2",Q.RK4="runge-kutta4",Q.VERLET="verlet",Q.PARTICLE_CREATED="partilcleCreated",Q.PARTICLE_UPDATE="partilcleUpdate",Q.PARTICLE_SLEEP="particleSleep",Q.PARTICLE_DEAD="partilcleDead",Q.PROTON_UPDATE="protonUpdate",Q.PROTON_UPDATE_AFTER="protonUpdateAfter",Q.EMITTER_ADDED="emitterAdded",Q.EMITTER_REMOVED="emitterRemoved",Q.amendChangeTabsBug=!0,Q.TextureBuffer={},Q.TextureCanvasBuffer={},Q.prototype={addRender:function(t){t.proton=this,this.renderers.push(t.proton)},addEmitter:function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent(Q.EMITTER_ADDED,t)},removeEmitter:function(t){var e=this.emitters.indexOf(t);this.emitters.splice(e,1),t.parent=null,this.dispatchEvent(Q.EMITTER_REMOVED,t)},update:function(){if(this.dispatchEvent(Q.PROTON_UPDATE),Q.USE_CLOCK){this.oldTime||(this.oldTime=(new Date).getTime());var t=(new Date).getTime();this.elapsed=(t-this.oldTime)/1e3,Q.amendChangeTabsBug&&this.amendChangeTabsBug(),this.oldTime=t}else this.elapsed=.0167;if(this.elapsed>0)for(var e=0;e<this.emitters.length;e++)this.emitters[e].update(this.elapsed);this.dispatchEvent(Q.PROTON_UPDATE_AFTER)},amendChangeTabsBug:function(){this.elapsed>.5&&(this.oldTime=(new Date).getTime(),this.elapsed=0)},getCount:function(){for(var t=0,e=this.emitters.length,i=0;e>i;i++)t+=this.emitters[i].particles.length;return t},destroy:function(){for(var t=this.emitters.length,e=0;t>e;e++)this.emitters[e].destroy(),delete this.emitters[e];this.emitters=[],this.time=0,this.oldTime=0,Q.pool.release()}},t.Proton=Q,W.initialize=function(t){t.addEventListener=Z.addEventListener,t.removeEventListener=Z.removeEventListener,t.removeAllEventListeners=Z.removeAllEventListeners,t.hasEventListener=Z.hasEventListener,t.dispatchEvent=Z.dispatchEvent};var Z=W.prototype;Z._listeners=null,Z.initialize=function(){},Z.addEventListener=function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e},Z.removeEventListener=function(t,e){if(this._listeners){if(!this._listeners[t])return;for(var i=this._listeners[t],r=0,s=i.length;s>r;r++)if(i[r]==e){1==s?delete this._listeners[t]:i.splice(r,1);break}}},Z.removeAllEventListeners=function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null},Z.dispatchEvent=function(t,e){var i=!1,r=this._listeners;if(t&&r){var s=r[t];if(!s)return i;s=s.slice();for(var n,a=s.length;a--;){var n=s[a];i=i||n(e)}}return!!i},Z.hasEventListener=function(t){var e=this._listeners;return!!e&&!!e[t]},W.initialize(Q.prototype),Q.EventDispatcher=W;var X=X||{initValue:function(t,i){var t=null!=t&&t!=e?t:i;return t},isArray:function(t){return"object"==typeof t&&t.hasOwnProperty("length")},destroyArray:function(t){t.length=0},destroyObject:function(t){for(var e in t)delete t[e]},getVector2D:function(t,e){if("object"==typeof t)return t;var i=new Q.Vector2D(t,e);return i},classApply:function(t,e){if(!e)return new t;var i=[null].concat(e),r=t.bind.apply(t,i);return new r},judgeVector2D:function(t){var e="";return(t.hasOwnProperty("x")||t.hasOwnProperty("y")||t.hasOwnProperty("p")||t.hasOwnProperty("position"))&&(e+="p"),(t.hasOwnProperty("vx")||t.hasOwnProperty("vx")||t.hasOwnProperty("v")||t.hasOwnProperty("velocity"))&&(e+="v"),(t.hasOwnProperty("ax")||t.hasOwnProperty("ax")||t.hasOwnProperty("a")||t.hasOwnProperty("accelerate"))&&(e+="a"),e},setVector2DByObject:function(t,e){e.hasOwnProperty("x")&&(t.p.x=e.x),e.hasOwnProperty("y")&&(t.p.y=e.y),e.hasOwnProperty("vx")&&(t.v.x=e.vx),e.hasOwnProperty("vy")&&(t.v.y=e.vy),e.hasOwnProperty("ax")&&(t.a.x=e.ax),e.hasOwnProperty("ay")&&(t.a.y=e.ay),e.hasOwnProperty("p")&&particle.p.copy(e.p),e.hasOwnProperty("v")&&particle.v.copy(e.v),e.hasOwnProperty("a")&&particle.a.copy(e.a),e.hasOwnProperty("position")&&particle.p.copy(e.position),e.hasOwnProperty("velocity")&&particle.v.copy(e.velocity),e.hasOwnProperty("accelerate")&&particle.a.copy(e.accelerate)},addPrototypeByObject:function(t,e,i){for(var r in e)i?i.indexOf(r)<0&&(t[r]=Q.Util.getSpanValue(e[r])):t[r]=Q.Util.getSpanValue(e[r]);return t},setPrototypeByObject:function(t,e,i){for(var r in e)t.hasOwnProperty(r)&&(i?i.indexOf(r)<0&&(t[r]=Q.Util.getSpanValue(e[r])):t[r]=Q.Util.getSpanValue(e[r]));return t},setSpanValue:function(t,e,i){return t instanceof Q.Span?t:e?i?new Q.Span(t,e,i):new Q.Span(t,e):new Q.Span(t)},getSpanValue:function(t){return t instanceof Q.Span?t.getValue():t},inherits:function(t,e){if(t._super_=e,Object.create)t.prototype=Object.create(e.prototype,{constructor:{value:t}});else{var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},getImageData:function(t,e,i){t.drawImage(e,i.x,i.y);var r=t.getImageData(i.x,i.y,i.width,i.height);return t.clearRect(i.x,i.y,i.width,i.height),r},getImage:function(t,e,i,r){"string"==typeof t?this.loadAndSetImage(t,e,i,r):"object"==typeof t?this.loadAndSetImage(t.src,e,i,r):t instanceof Image&&this.loadedImage(t.src,e,i,r,t)},loadedImage:function(t,e,i,r,s){if(e.target=s,e.transform.src=t,Q.TextureBuffer[t]||(Q.TextureBuffer[t]=e.target),i)if(Q.TextureCanvasBuffer[t])e.transform.canvas=Q.TextureCanvasBuffer[t];else{var n=Q.WebGLUtil.nhpot(e.target.width),a=Q.WebGLUtil.nhpot(e.target.height);e.transform.canvas=Q.DomUtil.createCanvas("canvas"+t,n,a);var o=e.transform.canvas.getContext("2d");o.drawImage(e.target,0,0,e.target.width,e.target.height),Q.TextureCanvasBuffer[t]=e.transform.canvas}r&&r(e)},loadAndSetImage:function(t,e,i,r){if(Q.TextureBuffer[t])this.loadedImage(t,e,i,r,Q.TextureBuffer[t]);else{var s=this,n=new Image;n.onload=function(n){s.loadedImage(t,e,i,r,n.target)},n.src=t}},hexToRGB:function(t){var e="#"==t.charAt(0)?t.substring(1,7):t,i=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),s=parseInt(e.substring(4,6),16);return{r:i,g:r,b:s}},rgbToHex:function(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"}};Q.Util=X,Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,r=function(){},s=function(){return i.apply(this instanceof r?this:t||this,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,s.prototype=new r,s});var Y=Y||{ipot:function(t){return 0==(t&t-1)},nhpot:function(t){--t;for(var e=1;32>e;e<<=1)t|=t>>e;return t+1},makeTranslation:function(t,e){return[1,0,0,0,1,0,t,e,1]},makeRotation:function(t){var e=Math.cos(t),i=Math.sin(t);return[e,-i,0,i,e,0,0,0,1]},makeScale:function(t,e){return[t,0,0,0,e,0,0,0,1]},matrixMultiply:function(t,e){var i=t[0],r=t[1],s=t[2],n=t[3],a=t[4],o=t[5],h=t[6],u=t[7],l=t[8],c=e[0],p=e[1],f=e[2],d=e[3],m=e[4],g=e[5],y=e[6],v=e[7],x=e[8];return[i*c+r*d+s*y,i*p+r*m+s*v,i*f+r*g+s*x,n*c+a*d+o*y,n*p+a*m+o*v,n*f+a*g+o*x,h*c+u*d+l*y,h*p+u*m+l*v,h*f+u*g+l*x]}};Q.WebGLUtil=Y;var H=H||{createCanvas:function(t,e,i,r){var s=document.createElement("canvas"),n=r?r:"absolute";return s.id=t,s.width=e,s.height=i,s.style.position=n,s.style.opacity=0,this.transformDom(s,-500,-500,0,0),s},transformDom:function(t,e,i,r,s){t.style.WebkitTransform="translate("+e+"px, "+i+"px) scale("+r+") rotate("+s+"deg)",t.style.MozTransform="translate("+e+"px, "+i+"px) scale("+r+") rotate("+s+"deg)",t.style.OTransform="translate("+e+"px, "+i+"px) scale("+r+") rotate("+s+"deg)",t.style.msTransform="translate("+e+"px, "+i+"px) scale("+r+") rotate("+s+"deg)",t.style.transform="translate("+e+"px, "+i+"px) scale("+r+") rotate("+s+"deg)"}};Q.DomUtil=H,N.prototype.set=function(t,e){0==e?Q.Mat3.set(t,this.mats[0]):Q.Mat3.multiply(this.mats[e-1],t,this.mats[e]),this.size=Math.max(this.size,e+1)},N.prototype.push=function(t){0==this.size?Q.Mat3.set(t,this.mats[0]):Q.Mat3.multiply(this.mats[this.size-1],t,this.mats[this.size]),this.size++},N.prototype.pop=function(){this.size>0&&this.size--},N.prototype.top=function(){return this.mats[this.size-1]},Q.MStack=N,q.ID=0,q.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/Math.PI)},reset:function(t){return this.life=1/0,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.target=null,this.sprite=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.easing=Q.ease.setEasingByName(Q.easeLinear),t?(this.transform={},this.p=new Q.Vector2D,this.v=new Q.Vector2D,this.a=new Q.Vector2D,this.old={p:new Q.Vector2D,v:new Q.Vector2D,a:new Q.Vector2D},this.behaviours=[]):(Q.Util.destroyObject(this.transform),this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.removeAllBehaviours()),this.transform.rgb={r:255,g:255,b:255},this},update:function(t,e){if(!this.sleep){this.age+=t;var i,r=this.behaviours.length;for(i=0;r>i;i++)this.behaviours[i]&&this.behaviours[i].applyBehaviour(this,t,e)}if(this.age>=this.life)this.destroy();else{var s=this.easing(this.age/this.life);this.energy=Math.max(1-s,0)}},addBehaviour:function(t){this.behaviours.push(t),t.hasOwnProperty("parents")&&t.parents.push(this),t.initialize(this)},addBehaviours:function(t){var e,i=t.length;for(e=0;i>e;e++)this.addBehaviour(t[e])},removeBehaviour:function(t){var e=this.behaviours.indexOf(t);if(e>-1){var t=this.behaviours.splice(e,1);t.parents=null}},removeAllBehaviours:function(){Q.Util.destroyArray(this.behaviours)},destroy:function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}},Q.Particle=q,G.prototype={create:function(t,e){return this.cID++,"function"==typeof t?Q.Util.classApply(t,e):t.clone()},getCount:function(){var t=0;for(var e in this.list)t+=this.list[e].length;return t++},get:function(t,e){var i,r=t.__puid||K.id(t);return i=this.list[r]&&this.list[r].length>0?this.list[r].pop():this.create(t,e),i.__puid=t.__puid||r,i},set:function(t){return this._getList(t.__puid).push(t)},destroy:function(){for(var t in this.list)this.list[t].length=0,delete this.list[t]},_getList:function(t){return t=t||"default",this.list[t]||(this.list[t]=[]),this.list[t]}},Q.Pool=G;var K={_id:0,_uids:{},id:function(t){for(var e in this._uids)if(this._uids[e]==t)return e;var i="PUID_"+this._id++;return this._uids[i]=t,i},hash:function(t){}},J={randomAToB:function(t,e,i){return i?Math.floor(Math.random()*(e-t))+t:t+Math.random()*(e-t)},randomFloating:function(t,e,i){return J.randomAToB(t-e,t+e,i)},randomZone:function(t){},degreeTransform:function(t){return t*Math.PI/180},toColor16:function(t){return"#"+t.toString(16)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}};Q.MathUtils=J;var $=function(t){this.type=Q.Util.initValue(t,Q.EULER)};$.prototype={integrate:function(t,e,i){this.eulerIntegrate(t,e,i)},eulerIntegrate:function(t,e,i){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.multiplyScalar(1/t.mass),t.v.add(t.a.multiplyScalar(e)),t.p.add(t.old.v.multiplyScalar(e)),i&&t.v.multiplyScalar(i),t.a.clear())}},Q.NumericalIntegration=$;var tt=function(t,e){this.x=t||0,this.y=e||0};tt.prototype={set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getGradient:function(){return 0!=this.x?Math.atan2(this.y,this.x):this.y>0?Math.PI/2:this.y<0?-Math.PI/2:void 0},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return i!==e?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this)},addXY:function(t,e){return this.x+=t,this.y+=e,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,i){return i!==e?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},rotate:function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)+i*Math.sin(t),this.y=-e*Math.sin(t)+i*Math.cos(t),this},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y},toArray:function(){return[this.x,this.y]},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new Q.Vector2D(this.x,this.y)}},Q.Vector2D=tt;var et=function(t,e){this.r=Math.abs(t)||0,this.tha=e||0};et.prototype={set:function(t,e){return this.r=t,this.tha=e,this},setR:function(t){return this.r=t,this},setTha:function(t){return this.tha=t,this},copy:function(t){return this.r=t.r,this.tha=t.tha,this},toVector:function(){return new Q.Vector2D(this.getX(),this.getY())},getX:function(){return this.r*Math.sin(this.tha)},getY:function(){return-this.r*Math.cos(this.tha)},normalize:function(){return this.r=1,this},equals:function(t){return t.r===this.r&&t.tha===this.tha},toArray:function(){return[this.r,this.tha]},clear:function(){return this.r=0,this.tha=0,this},clone:function(){return new Q.Polar2D(this.r,this.tha)}},Q.Polar2D=et,j.prototype={getValue:function(t){return this.isArray?this.a[Math.floor(this.a.length*Math.random())]:this.center?Q.MathUtils.randomFloating(this.a,this.b,t):Q.MathUtils.randomAToB(this.a,this.b,t)}},Q.Span=j,Q.getSpan=function(t,e,i){return new Q.Span(t,e,i)},Q.Util.inherits(z,Q.Span),z.prototype.getValue=function(){var t=this.colorArr[Math.floor(this.colorArr.length*Math.random())];return"random"==t||"Random"==t?Q.MathUtils.randomColor():t},Q.ColorSpan=z,F.prototype={contains:function(t,e){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y?!0:!1}},Q.Rectangle=F;var it=it||{create:function(t){var e=new Float32Array(9);return t&&this.set(t,e),e},set:function(t,e){for(var i=0;9>i;i++)e[i]=t[i];return e},multiply:function(t,e,i){var r=t[0],s=t[1],n=t[2],a=t[3],o=t[4],h=t[6],u=t[7],l=e[0],c=e[1],p=e[2],f=e[3],d=e[4],m=e[6],g=e[7];return i[0]=l*r+c*a,i[1]=l*s+c*o,i[2]=n*p,i[3]=f*r+d*a,i[4]=f*s+d*o,i[6]=m*r+g*a+h,i[7]=m*s+g*o+u,i},inverse:function(t,e){var i,r=t[0],s=t[1],n=t[3],a=t[4],o=t[6],h=t[7],u=a,l=-n,c=h*n-a*o,p=r*u+s*l;return i=1/p,e[0]=u*i,e[1]=-s*i,e[3]=l*i,e[4]=r*i,e[6]=c*i,e[7]=(-h*r+s*o)*i,e},multiplyVec2:function(t,e,i){var r=e[0],s=e[1];return i[0]=r*t[0]+s*t[3]+t[6],i[1]=r*t[1]+s*t[4]+t[7],i}};Q.Mat3=it,k.id=0,k.prototype={reset:function(t,e){this.life=Q.Util.initValue(t,1/0),this.easing=Q.Util.initValue(e,Q.ease.setEasingByName(Q.easeLinear))},normalizeForce:function(t){return t.multiplyScalar(Q.MEASURE)},normalizeValue:function(t){return t*Q.MEASURE},initialize:function(t){},applyBehaviour:function(t,e,i){if(this.age+=e,this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var r=this.easing(t.age/t.life);this.energy=Math.max(1-r,0)}},destroy:function(){var t,e=this.parents.length;for(t=0;e>t;t++)this.parents[t].removeBehaviour(this);this.parents=[]}},Q.Behaviour=k,L.prototype={init:function(){this.startTime=0,this.nextTime=this.timePan.getValue()},getValue:function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1==this.numPan.b?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)):0}},Q.Rate=L,O.prototype.reset=function(){},O.prototype.init=function(t,e){e?this.initialize(e):this.initialize(t)},O.prototype.initialize=function(t){},Q.Initialize=O;var rt={initialize:function(t,e,i){var r,s=i.length;for(r=0;s>r;r++)i[r]instanceof Q.Initialize?i[r].init(t,e):Q.InitializeUtil.init(t,e,i[r]);Q.InitializeUtil.bindEmitter(t,e)},init:function(t,e,i){Q.Util.setPrototypeByObject(e,i),Q.Util.setVector2DByObject(e,i)},bindEmitter:function(t,e){t.bindEmitter&&(e.p.add(t.p),e.v.add(t.v),e.a.add(t.a),e.v.rotate(Q.MathUtils.degreeTransform(t.rotation)))}};Q.InitializeUtil=rt,Q.Util.inherits(C,Q.Initialize),C.prototype.initialize=function(t){this.lifePan.a==1/0?t.life=1/0:t.life=this.lifePan.getValue()},Q.Life=C,Q.Util.inherits(M,Q.Initialize),M.prototype.reset=function(t){this.zone=Q.Util.initValue(t,new Q.PointZone)},M.prototype.initialize=function(t){this.zone.getPosition(),t.p.x=this.zone.vector.x,t.p.y=this.zone.vector.y},Q.Position=M,Q.P=M,Q.Util.inherits(V,Q.Initialize),V.prototype.reset=function(t,e,i){this.rPan=Q.Util.setSpanValue(t),this.thaPan=Q.Util.setSpanValue(e),this.type=Q.Util.initValue(i,"vector")},V.prototype.normalizeVelocity=function(t){return t*Q.MEASURE},V.prototype.initialize=function(t){if("p"==this.type||"P"==this.type||"polar"==this.type){var e=new Q.Polar2D(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*Math.PI/180);t.v.x=e.getX(),t.v.y=e.getY()}else t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue())},Q.Velocity=V,Q.V=V,Q.Util.inherits(D,Q.Initialize),D.prototype.initialize=function(t){t.mass=this.massPan.getValue()},Q.Mass=D,Q.Util.inherits(B,Q.Initialize),B.prototype.reset=function(t,e,i){this.radius=Q.Util.setSpanValue(t,e,i)},B.prototype.initialize=function(t){t.radius=this.radius.getValue(),t.transform.oldRadius=t.radius},Q.Radius=B,Q.Util.inherits(A,Q.Initialize),A.prototype.initialize=function(t){var e=this.image.getValue();"string"==typeof e?t.target={width:this.w,height:this.h,src:e}:t.target=e},A.prototype.setSpanValue=function(t){return t instanceof Q.ColorSpan?t:new Q.ColorSpan(t)},Q.ImageTarget=A,Q.Util.inherits(S,Q.Behaviour),S.prototype.reset=function(t,e,i,r){this.force=this.normalizeForce(new Q.Vector2D(t,e)),i&&S._super_.prototype.reset.call(this,i,r)},S.prototype.applyBehaviour=function(t,e,i){S._super_.prototype.applyBehaviour.call(this,t,e,i),t.a.add(this.force)},Q.Force=S,Q.F=S,Q.Util.inherits(I,Q.Behaviour),I.prototype.reset=function(t,e,i,r,s){this.targetPosition=Q.Util.initValue(t,new Q.Vector2D),this.radius=Q.Util.initValue(i,1e3),this.force=Q.Util.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new Q.Vector2D,this.lengthSq=0,r&&I._super_.prototype.reset.call(this,r,s)},I.prototype.applyBehaviour=function(t,e,i){I._super_.prototype.applyBehaviour.call(this,t,e,i),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),t.a.add(this.attractionForce))},Q.Attraction=I,Q.Util.inherits(T,Q.Behaviour),T.prototype.reset=function(t,e,i,r,s){this.panFoce=new Q.Vector2D(t,e),this.panFoce=this.normalizeForce(this.panFoce),this.delay=i,r&&T._super_.prototype.reset.call(this,r,s)},T.prototype.applyBehaviour=function(t,e,i){T._super_.prototype.applyBehaviour.call(this,t,e,i),this.time+=e,this.time>=this.delay&&(t.a.addXY(Q.MathUtils.randomAToB(-this.panFoce.x,this.panFoce.x),Q.MathUtils.randomAToB(-this.panFoce.y,this.panFoce.y)),this.time=0)},Q.RandomDrift=T,Q.Util.inherits(R,Q.Attraction),R.prototype.reset=function(t,e,i,r,s){R._super_.prototype.reset.call(this,t,e,i,r,s),this.force*=-1},Q.Repulsion=R,Q.Util.inherits(P,Q.Force),P.prototype.reset=function(t,e,i){P._super_.prototype.reset.call(this,0,t,e,i)},Q.Gravity=P,Q.G=P,Q.Util.inherits(U,Q.Behaviour),U.prototype.reset=function(t,e,i,r,s){this.emitter=Q.Util.initValue(t,null),this.mass=Q.Util.initValue(e,!0),this.callback=Q.Util.initValue(i,null),this.collisionPool=[],this.delta=new Q.Vector2D,r&&U._super_.prototype.reset.call(this,r,s)},U.prototype.applyBehaviour=function(t,e,i){for(var r,s,n,a,o,h=this.emitter?this.emitter.particles.slice(i):this.pool.slice(i),u=h.length,l=0;u>l;l++)r=h[l],r!==t&&(this.delta.copy(r.p),this.delta.sub(t.p),s=this.delta.lengthSq(),distance=t.radius+r.radius,s<=distance*distance&&(n=distance-Math.sqrt(s),n+=.5,totalMass=t.mass+r.mass,a=this.mass?r.mass/totalMass:.5,o=this.mass?t.mass/totalMass:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(n*-a)),r.p.add(this.delta.normalize().multiplyScalar(n*o)),this.callback&&this.callback(t,r)))},Q.Collision=U,Q.Util.inherits(E,Q.Behaviour),E.prototype.reset=function(t,e,i,r){this.zone=t,this.zone.crossType=Q.Util.initValue(e,"dead"),i&&E._super_.prototype.reset.call(this,i,r)},E.prototype.applyBehaviour=function(t,e,i){E._super_.prototype.applyBehaviour.call(this,t,e,i),this.zone.crossing(t)},Q.CrossZone=E,Q.Util.inherits(_,Q.Behaviour),_.prototype.reset=function(t,i,r,s){null==i||i==e?this.same=!0:this.same=!1,this.a=Q.Util.setSpanValue(Q.Util.initValue(t,1)),this.b=Q.Util.setSpanValue(i),r&&_._super_.prototype.reset.call(this,r,s)},_.prototype.initialize=function(t){t.transform.alphaA=this.a.getValue(),this.same?t.transform.alphaB=t.transform.alphaA:t.transform.alphaB=this.b.getValue()},_.prototype.applyBehaviour=function(t,e,i){_._super_.prototype.applyBehaviour.call(this,t,e,i),t.alpha=t.transform.alphaB+(t.transform.alphaA-t.transform.alphaB)*this.energy,t.alpha<.001&&(t.alpha=0)},Q.Alpha=_,Q.Util.inherits(w,Q.Behaviour),w.prototype.reset=function(t,i,r,s){null==i||i==e?this.same=!0:this.same=!1,this.a=Q.Util.setSpanValue(Q.Util.initValue(t,1)),this.b=Q.Util.setSpanValue(i),r&&w._super_.prototype.reset.call(this,r,s)},w.prototype.initialize=function(t){t.transform.scaleA=this.a.getValue(),t.transform.oldRadius=t.radius,this.same?t.transform.scaleB=t.transform.scaleA:t.transform.scaleB=this.b.getValue()},w.prototype.applyBehaviour=function(t,e,i){w._super_.prototype.applyBehaviour.call(this,t,e,i),t.scale=t.transform.scaleB+(t.transform.scaleA-t.transform.scaleB)*this.energy,t.scale<1e-4&&(t.scale=0),t.radius=t.transform.oldRadius*t.scale},Q.Scale=w,Q.Util.inherits(b,Q.Behaviour),b.prototype.reset=function(t,i,r,s,n){null==i||i==e?this.same=!0:this.same=!1,this.a=Q.Util.setSpanValue(Q.Util.initValue(t,"Velocity")),this.b=Q.Util.setSpanValue(Q.Util.initValue(i,0)),this.style=Q.Util.initValue(r,"to"),s&&b._super_.prototype.reset.call(this,s,n)},b.prototype.initialize=function(t){t.rotation=this.a.getValue(),t.transform.rotationA=this.a.getValue(),this.same||(t.transform.rotationB=this.b.getValue())},b.prototype.applyBehaviour=function(t,e,i){b._super_.prototype.applyBehaviour.call(this,t,e,i),this.same?("V"==this.a.a||"Velocity"==this.a.a||"v"==this.a.a)&&(t.rotation=t.getDirection()):"to"==this.style||"TO"==this.style||"_"==this.style?t.rotation+=t.transform.rotationB+(t.transform.rotationA-t.transform.rotationB)*this.energy:t.rotation+=t.transform.rotationB},Q.Rotate=b,Q.Util.inherits(x,Q.Behaviour),x.prototype.reset=function(t,e,i,r){this.color1=this.setSpanValue(t),this.color2=this.setSpanValue(e),i&&x._super_.prototype.reset.call(this,i,r)},x.prototype.initialize=function(t){t.color=this.color1.getValue(),t.transform.beginRGB=Q.Util.hexToRGB(t.color),this.color2&&(t.transform.endRGB=Q.Util.hexToRGB(this.color2.getValue()))},x.prototype.applyBehaviour=function(t,e,i){this.color2?(x._super_.prototype.applyBehaviour.call(this,t,e,i),t.transform.rgb.r=t.transform.endRGB.r+(t.transform.beginRGB.r-t.transform.endRGB.r)*this.energy,t.transform.rgb.g=t.transform.endRGB.g+(t.transform.beginRGB.g-t.transform.endRGB.g)*this.energy,t.transform.rgb.b=t.transform.endRGB.b+(t.transform.beginRGB.b-t.transform.endRGB.b)*this.energy,t.transform.rgb.r=parseInt(t.transform.rgb.r,10),t.transform.rgb.g=parseInt(t.transform.rgb.g,10),t.transform.rgb.b=parseInt(t.transform.rgb.b,10)):(t.transform.rgb.r=t.transform.beginRGB.r,t.transform.rgb.g=t.transform.beginRGB.g,t.transform.rgb.b=t.transform.beginRGB.b)},x.prototype.setSpanValue=function(t){return t?t instanceof Q.ColorSpan?t:new Q.ColorSpan(t):null},Q.Color=x,Q.Util.inherits(v,Q.Behaviour),v.prototype.reset=function(t,e,i,r){this.distanceVec=new Q.Vector2D,this.centerPoint=Q.Util.initValue(t,new Q.Vector2D),this.force=Q.Util.initValue(this.normalizeValue(e),100),i&&v._super_.prototype.reset.call(this,i,r)},v.prototype.initialize=function(t){},v.prototype.applyBehaviour=function(t,e,i){this.distanceVec.set(this.centerPoint.x-t.p.x,this.centerPoint.y-t.p.y);var r=this.distanceVec.lengthSq();if(0!=r){var s=this.distanceVec.length(),n=this.force*e/(r*s);t.v.x+=n*this.distanceVec.x,t.v.y+=n*this.distanceVec.y}},Q.GravityWell=v,y.ID=0,Q.Util.inherits(y,Q.Particle),Q.EventDispatcher.initialize(y.prototype),y.prototype.emit=function(t,e){this.emitTime=0,this.emitTotalTimes=Q.Util.initValue(t,1/0),1==e||"life"==e||"destroy"==e?"once"==t?this.life=1:this.life=this.emitTotalTimes:isNaN(e)||(this.life=e),this.rate.init()},y.prototype.stopEmit=function(){this.emitTotalTimes=-1,this.emitTime=0},y.prototype.removeAllParticles=function(){for(var t=0;t<this.particles.length;t++)this.particles[t].dead=!0},y.prototype.createParticle=function(t,e){var i=Q.pool.get(Q.Particle);return this.setupParticle(i,t,e),this.dispatchEvent(Q.PARTICLE_CREATED,i),
i},y.prototype.addSelfInitialize=function(t){t.init?t.init(this):this.initAll()},y.prototype.addInitialize=function(){var t,e=arguments.length;for(t=0;e>t;t++)this.initializes.push(arguments[t])},y.prototype.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},y.prototype.removeInitializers=function(){Q.Util.destroyArray(this.initializes)},y.prototype.addBehaviour=function(){var t,e=arguments.length;for(t=0;e>t;t++)this.behaviours.push(arguments[t]),arguments[t].hasOwnProperty("parents")&&arguments[t].parents.push(this)},y.prototype.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)},y.prototype.removeAllBehaviours=function(){Q.Util.destroyArray(this.behaviours)},y.prototype.integrate=function(t){var e=1-this.damping;Q.integrator.integrate(this,t,e);var i,r=this.particles.length;for(i=0;r>i;i++){var s=this.particles[i];s.update(t,i),Q.integrator.integrate(s,t,e),this.dispatchEvent(Q.PARTICLE_UPDATE,s)}},y.prototype.emitting=function(t){if("once"==this.emitTotalTimes){var e,i=this.rate.getValue(99999);for(e=0;i>e;e++)this.createParticle();this.emitTotalTimes="none"}else if(!isNaN(this.emitTotalTimes)&&(this.emitTime+=t,this.emitTime<this.emitTotalTimes)){var e,i=this.rate.getValue(t);for(e=0;i>e;e++)this.createParticle()}},y.prototype.update=function(t){this.age+=t,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(t),this.integrate(t);var e,i,r=this.particles.length;for(i=r-1;i>=0;i--)e=this.particles[i],e.dead&&(this.dispatchEvent(Q.PARTICLE_DEAD,e),Q.pool.set(e),this.particles.splice(i,1))},y.prototype.setupParticle=function(t,e,i){var r=this.initializes,s=this.behaviours;e&&(r=e instanceof Array?e:[e]),i&&(s=i instanceof Array?i:[i]),t.reset(),Q.InitializeUtil.initialize(this,t,r),t.addBehaviours(s),t.parent=this,this.particles.push(t)},y.prototype.destroy=function(){this.dead=!0,this.emitTotalTimes=-1,0==this.particles.length&&(this.removeInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this))},Q.Emitter=y,Q.Util.inherits(g,Q.Emitter),g.prototype.addSelfBehaviour=function(){var t,e=arguments.length;for(t=0;e>t;t++)this.selfBehaviours.push(arguments[t])},g.prototype.removeSelfBehaviour=function(t){var e=this.selfBehaviours.indexOf(t);e>-1&&this.selfBehaviours.splice(e,1)},g.prototype.update=function(t){if(g._super_.prototype.update.call(this,t),!this.sleep){var e,i=this.selfBehaviours.length;for(e=0;i>e;e++)this.selfBehaviours[e].applyBehaviour(this,t,e)}},Q.BehaviourEmitter=g,Q.Util.inherits(m,Q.Emitter),m.prototype.initEventHandler=function(){var t=this;this.mousemoveHandler=function(e){t.mousemove.call(t,e)},this.mousedownHandler=function(e){t.mousedown.call(t,e)},this.mouseupHandler=function(e){t.mouseup.call(t,e)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},m.prototype.emit=function(){this._allowEmitting=!0},m.prototype.stopEmit=function(){this._allowEmitting=!1},m.prototype.mousemove=function(t){t.layerX||0==t.layerX?(this.p.x+=(t.layerX-this.p.x)*this.ease,this.p.y+=(t.layerY-this.p.y)*this.ease):(t.offsetX||0==t.offsetX)&&(this.p.x+=(t.offsetX-this.p.x)*this.ease,this.p.y+=(t.offsetY-this.p.y)*this.ease),this._allowEmitting&&m._super_.prototype.emit.call(this,"once")},m.prototype.destroy=function(){m._super_.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},Q.FollowEmitter=m;var st=st||{easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return-Math.cos(t*(Math.PI/2))+1},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},setEasingByName:function(t){switch(t){case"easeLinear":return Q.ease.easeLinear;case"easeInQuad":return Q.ease.easeInQuad;case"easeOutQuad":return Q.ease.easeOutQuad;case"easeInOutQuad":return Q.ease.easeInOutQuad;case"easeInCubic":return Q.ease.easeInCubic;case"easeOutCubic":return Q.ease.easeOutCubic;case"easeInOutCubic":return Q.ease.easeInOutCubic;case"easeInQuart":return Q.ease.easeInQuart;case"easeOutQuart":return Q.ease.easeOutQuart;case"easeInOutQuart":return Q.ease.easeInOutQuart;case"easeInSine":return Q.ease.easeInSine;case"easeOutSine":return Q.ease.easeOutSine;case"easeInOutSine":return Q.ease.easeInOutSine;case"easeInExpo":return Q.ease.easeInExpo;case"easeOutExpo":return Q.ease.easeOutExpo;case"easeInOutExpo":return Q.ease.easeInOutExpo;case"easeInCirc":return Q.ease.easeInCirc;case"easeOutCirc":return Q.ease.easeOutCirc;case"easeInOutCirc":return Q.ease.easeInOutCirc;case"easeInBack":return Q.ease.easeInBack;case"easeOutBack":return Q.ease.easeOutBack;case"easeInOutBack":return Q.ease.easeInOutBack;default:return Q.ease.easeLinear}}};Q.ease=st,Q.easeLinear="easeLinear",Q.easeInQuad="easeInQuad",Q.easeOutQuad="easeOutQuad",Q.easeInOutQuad="easeInOutQuad",Q.easeInCubic="easeInCubic",Q.easeOutCubic="easeOutCubic",Q.easeInOutCubic="easeInOutCubic",Q.easeInQuart="easeInQuart",Q.easeOutQuart="easeOutQuart",Q.easeInOutQuart="easeInOutQuart",Q.easeInSine="easeInSine",Q.easeOutSine="easeOutSine",Q.easeInOutSine="easeInOutSine",Q.easeInExpo="easeInExpo",Q.easeOutExpo="easeOutExpo",Q.easeInOutExpo="easeInOutExpo",Q.easeInCirc="easeInCirc",Q.easeOutCirc="easeOutCirc",Q.easeInOutCirc="easeInOutCirc",Q.easeInBack="easeInBack",Q.easeOutBack="easeOutBack",Q.easeInOutBack="easeInOutBack",d.prototype={start:function(){this.addEventHandler(),this.renderer.start()},stop:function(){this.renderer.stop()},resize:function(t,e){this.renderer.resize(t,e)},setStroke:function(t,e){this.renderer.hasOwnProperty("stroke")?this.renderer.setStroke(t,e):alert("Sorry this renderer do not suppest stroke method!")},createImageData:function(t){this.renderer instanceof Q.PixelRender&&this.renderer.createImageData(t)},setMaxRadius:function(t){this.renderer instanceof Q.WebGLRender&&this.renderer.setMaxRadius(t)},blendEquation:function(t){this.renderer instanceof Q.WebGLRender&&this.renderer.blendEquation(t)},blendFunc:function(t,e){this.renderer instanceof Q.WebGLRender&&this.renderer.blendFunc(t,e)},setType:function(t){this.type=t,this.renderer=this.getRenderer()},getRenderer:function(){switch(this.type){case"pixi":return new Q.PixiRender(this.proton,this.element);case"dom":return new Q.DomRender(this.proton,this.element);case"canvas":return new Q.CanvasRender(this.proton,this.element);case"webgl":return new Q.WebGLRender(this.proton,this.element);case"easel":return new Q.EaselRender(this.proton,this.element);case"easeljs":return new Q.EaselRender(this.proton,this.element);case"pixel":return new Q.PixelRender(this.proton,this.element);default:return new Q.BaseRender(this.proton,this.element)}},render:function(t){this.renderer.render(t)},addEventHandler:function(){this.onProtonUpdate&&(this.renderer.onProtonUpdate=this.onProtonUpdate),this.onParticleCreated&&(this.renderer.onParticleCreated=this.onParticleCreated),this.onParticleUpdate&&(this.renderer.onParticleUpdate=this.onParticleUpdate),this.onParticleDead&&(this.renderer.onParticleDead=this.onParticleDead)}},Q.Renderer=d,f.prototype={start:function(){var t=this;this.proton.addEventListener(Q.PROTON_UPDATE,function(){t.onProtonUpdate.call(t)}),this.proton.addEventListener(Q.PROTON_UPDATE_AFTER,function(){t.onProtonUpdateAfter.call(t)}),this.proton.addEventListener(Q.EMITTER_ADDED,function(e){t.onEmitterAdded.call(t,e)}),this.proton.addEventListener(Q.EMITTER_REMOVED,function(e){t.onEmitterRemoved.call(t,e)});var e,i=this.proton.emitters.length;for(e=0;i>e;e++){var r=this.proton.emitters[e];this.addEmitterListener(r)}},resize:function(t,e){},addEmitterListener:function(t){var e=this;t.addEventListener(Q.PARTICLE_CREATED,function(t){e.onParticleCreated.call(e,t)}),t.addEventListener(Q.PARTICLE_UPDATE,function(t){e.onParticleUpdate.call(e,t)}),t.addEventListener(Q.PARTICLE_DEAD,function(t){e.onParticleDead.call(e,t)})},stop:function(){var t,e=this.proton.emitters.length;for(this.proton.removeAllEventListeners(),t=0;e>t;t++){var i=this.proton.emitters[t];i.removeAllEventListeners()}},onEmitterAdded:function(t){this.addEmitterListener(t)},onEmitterRemoved:function(t){t.removeAllEventListeners()},onProtonUpdate:function(){},onProtonUpdateAfter:function(){},onParticleCreated:function(t){},onParticleUpdate:function(t){},onParticleDead:function(t){}},Q.BaseRender=f,Q.Util.inherits(p,Q.BaseRender),p.prototype.start=function(){p._super_.prototype.start.call(this)},p.prototype.setStroke=function(t,e){t=Q.Util.initValue(t,"#000000"),e=Q.Util.initValue(e,1),this.stroke={color:t,thinkness:e}},p.prototype.onProtonUpdate=function(){},p.prototype.onParticleCreated=function(t){if(t.target){var e=this;Q.Util.getImage(t.target,t,!1,function(t){e.setImgInDIV.call(e,t)})}else t.transform.canvas=Q.DomUtil.createCanvas(t.id+"_canvas",t.radius+1,t.radius+1,"absolute"),t.transform.bakOldRadius=t.radius,this.stroke?(t.transform.canvas.width=2*t.radius+2*this.stroke.thinkness,t.transform.canvas.height=2*t.radius+2*this.stroke.thinkness):(t.transform.canvas.width=2*t.radius+1,t.transform.canvas.height=2*t.radius+1),t.transform.context=t.transform.canvas.getContext("2d"),t.transform.context.fillStyle=t.color,t.transform.context.beginPath(),t.transform.context.arc(t.radius,t.radius,t.radius,0,2*Math.PI,!0),this.stroke&&(t.transform.context.strokeStyle=this.stroke.color,t.transform.context.lineWidth=this.stroke.thinkness,t.transform.context.stroke()),t.transform.context.closePath(),t.transform.context.fill(),this.element.appendChild(t.transform.canvas)},p.prototype.onParticleUpdate=function(t){t.target?t.target instanceof Image&&(t.transform.canvas.style.opacity=t.alpha,Q.DomUtil.transformDom(t.transform.canvas,t.p.x-t.target.width/2,t.p.y-t.target.height/2,t.scale,t.rotation)):(t.transform.canvas.style.opacity=t.alpha,t.transform.oldRadius?Q.DomUtil.transformDom(t.transform.canvas,t.p.x-t.transform.oldRadius,t.p.y-t.transform.oldRadius,t.scale,t.rotation):Q.DomUtil.transformDom(t.transform.canvas,t.p.x-t.transform.bakOldRadius,t.p.y-t.transform.bakOldRadius,t.scale,t.rotation))},p.prototype.onParticleDead=function(t){t.transform.canvas&&this.element.removeChild(t.transform.canvas)},p.prototype.setImgInDIV=function(t){t.transform.canvas=Q.DomUtil.createCanvas(t.id+"_canvas",t.target.width+1,t.target.height+1,"absolute",t.p.x-t.radius,t.p.y-t.radius),t.transform.context=t.transform.canvas.getContext("2d"),t.transform.context.drawImage(t.target,0,0,t.target.width,t.target.height),this.element.appendChild(t.transform.canvas)},Q.DomRender=p,Q.Util.inherits(c,Q.BaseRender),c.prototype.resize=function(t,e){},c.prototype.start=function(){c._super_.prototype.start.call(this)},c.prototype.onProtonUpdate=function(){},c.prototype.onParticleCreated=function(t){if(t.target)t.target=this.pool.get(t.target),t.target.parent||(!t.target.image||(t.target.regX=t.target.image.width/2,t.target.regY=t.target.image.height/2),this.element.addChild(t.target));else{var e=this.pool.get(createjs.Graphics);this.stroke&&(1==this.stroke?e.beginStroke("#000000"):this.stroke instanceof String&&e.beginStroke(this.stroke)),e.beginFill(t.color).drawCircle(0,0,t.radius);var i=new createjs.Shape(e);t.target=i,this.element.addChild(t.target)}},c.prototype.onParticleUpdate=function(t){t.target&&(t.target.x=t.p.x,t.target.y=t.p.y,t.target.alpha=t.alpha,t.target.scaleX=t.target.scaleY=t.scale,t.target.rotation=t.rotation)},c.prototype.onParticleDead=function(t){t.target&&(t.target.parent&&t.target.parent.removeChild(t.target),this.pool.set(t.target),t.target=null)},Q.EaselRender=c,Q.Util.inherits(l,Q.BaseRender),l.prototype.resize=function(t,e){this.element.width=t,this.element.height=e},l.prototype.start=function(){l._super_.prototype.start.call(this)},l.prototype.setStroke=function(t,e){t=Q.Util.initValue(t,"#000000"),e=Q.Util.initValue(e,1),this.stroke={color:t,thinkness:e}},l.prototype.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},l.prototype.onParticleCreated=function(t){t.target?Q.Util.getImage(t.target,t,!1):t.color=t.color?t.color:"#ff0000"},l.prototype.onParticleUpdate=function(t){if(t.target){if(t.target instanceof Image){var e=t.target.width*t.scale|0,i=t.target.height*t.scale|0,r=t.p.x-e/2,s=t.p.y-i/2;if(t.color){t.transform.buffer||(t.transform.buffer=this.getBuffer(t.target));var n=t.transform.buffer.getContext("2d");n.clearRect(0,0,t.transform.buffer.width,t.transform.buffer.height),n.globalAlpha=t.alpha,n.drawImage(t.target,0,0),n.globalCompositeOperation="source-atop",n.fillStyle=Q.Util.rgbToHex(t.transform.rgb),n.fillRect(0,0,t.transform.buffer.width,t.transform.buffer.height),n.globalCompositeOperation="source-over",n.globalAlpha=1,this.context.drawImage(t.transform.buffer,0,0,t.transform.buffer.width,t.transform.buffer.height,r,s,e,i)}else this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(Q.MathUtils.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.target,0,0,t.target.width,t.target.height,r,s,e,i),this.context.globalAlpha=1,this.context.restore()}}else t.transform.rgb?this.context.fillStyle="rgba("+t.transform.rgb.r+","+t.transform.rgb.g+","+t.transform.rgb.b+","+t.alpha+")":this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},l.prototype.onParticleDead=function(t){},l.prototype.getBuffer=function(t){if(t instanceof Image){var e=t.width+"_"+t.height,i=this.bufferCache[e];return i||(i=document.createElement("canvas"),i.width=t.width,i.height=t.height,this.bufferCache[e]=i),i}},Q.CanvasRender=l,Q.Util.inherits(u,Q.BaseRender),u.prototype.resize=function(t,e){this.element.width=t,this.element.height=e},u.prototype.createImageData=function(t){t?this.rectangle=t:this.rectangle=new Q.Rectangle(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},u.prototype.start=function(){u._super_.prototype.start.call(this)},u.prototype.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},u.prototype.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},u.prototype.onParticleCreated=function(t){},u.prototype.onParticleUpdate=function(t){this.imageData&&this.setPixel(this.imageData,Math.floor(t.p.x-this.rectangle.x),Math.floor(t.p.y-this.rectangle.y),t)},u.prototype.setPixel=function(t,e,i,r){var s=r.transform.rgb;if(!(0>e||e>this.element.width||0>i||i>this.elementwidth)){var n=4*((i>>0)*t.width+(e>>0));t.data[n]=s.r,t.data[n+1]=s.g,t.data[n+2]=s.b,t.data[n+3]=255*r.alpha}},u.prototype.onParticleDead=function(t){},Q.PixelRender=u,Q.Util.inherits(h,Q.BaseRender),h.prototype.resize=function(t,e){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/t,this.smat[4]=1/e,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,t,e),this.element.width=t,this.element.height=e},h.prototype.setMaxRadius=function(t){this.circleCanvasURL=this.createCircle(t)},h.prototype.getVertexShader=function(){var t=["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join("\n");return t},h.prototype.getFragmentShader=function(){var t=["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join("\n");return t},h.prototype.initVar=function(){this.mstack=new Q.MStack,this.umat=Q.Mat3.create([2,0,1,0,-2,0,-1,1,1]),this.smat=Q.Mat3.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},h.prototype.start=function(){h._super_.prototype.start.call(this),this.resize(this.element.width,this.element.height)},h.prototype.blendEquation=function(t){this.gl.blendEquation(this.gl[t])},h.prototype.blendFunc=function(t,e){this.gl.blendFunc(this.gl[t],this.gl[e])},h.prototype.getShader=function(t,e,i){var r;return r=i?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER),t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(alert(t.getShaderInfoLog(r)),null)},h.prototype.initShaders=function(){var t=this.getShader(this.gl,this.getFragmentShader(),!0),e=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,e),this.gl.attachShader(this.sprogram,t),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},h.prototype.initBuffers=function(){this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer);var t=[0,3,1,0,2,3];this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this.gl.STATIC_DRAW);for(var e=[],i=0;100>i;i++)e.push(i);for(idx=new Uint16Array(e),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW),e=[],i=0;100>i;i++)e.push(i,i+1,i+2);idx=new Uint16Array(e),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW)},h.prototype.createCircle=function(t){this.circleCanvasRadius=Q.WebGLUtil.nhpot(Q.Util.initValue(t,32));var e=Q.DomUtil.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),i=e.getContext("2d");return i.beginPath(),i.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),i.closePath(),i.fillStyle="#FFF",i.fill(),e.toDataURL()},h.prototype.setImgInCanvas=function(t){var e=t.target.width,i=t.target.height,r=Q.WebGLUtil.nhpot(t.target.width),s=Q.WebGLUtil.nhpot(t.target.height),n=t.target.width/r,a=t.target.height/s;this.texturebuffers[t.transform.src]||(this.texturebuffers[t.transform.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.transform.texture=this.texturebuffers[t.transform.src][0],t.transform.vcBuffer=this.texturebuffers[t.transform.src][1],t.transform.tcBuffer=this.texturebuffers[t.transform.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,n,0,0,a,a,a]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,e,0,0,i,e,i]),this.gl.STATIC_DRAW);var o=t.transform.canvas.getContext("2d"),h=o.getImageData(0,0,r,s);this.gl.bindTexture(this.gl.TEXTURE_2D,t.transform.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,h),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.transform.textureLoaded=!0,t.transform.textureWidth=e,t.transform.textureHeight=i},h.prototype.setStroke=function(t,e){},h.prototype.onProtonUpdate=function(){},h.prototype.onParticleCreated=function(t){var e=this;t.transform.textureLoaded=!1,t.transform.tmat=Q.Mat3.create(),t.transform.tmat[8]=1,t.transform.imat=Q.Mat3.create(),t.transform.imat[8]=1,t.target?Q.Util.getImage(t.target,t,!0,function(t){e.setImgInCanvas.call(e,t),t.transform.oldScale=1}):Q.Util.getImage(this.circleCanvasURL,t,!0,function(t){e.setImgInCanvas.call(e,t),t.transform.oldScale=t.radius/e.circleCanvasRadius})},h.prototype.onParticleUpdate=function(t){t.transform.textureLoaded&&(this.updateMatrix(t),this.gl.uniform3f(this.sprogram.color,t.transform.rgb.r/255,t.transform.rgb.g/255,t.transform.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,t.transform.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},h.prototype.onParticleDead=function(t){},h.prototype.updateMatrix=function(t){var e=Q.WebGLUtil.makeTranslation(-t.transform.textureWidth/2,-t.transform.textureHeight/2),i=Q.WebGLUtil.makeTranslation(t.p.x,t.p.y),r=t.rotation*(Math.PI/180),s=Q.WebGLUtil.makeRotation(r),n=t.scale*t.transform.oldScale,a=Q.WebGLUtil.makeScale(n,n),o=Q.WebGLUtil.matrixMultiply(e,a);o=Q.WebGLUtil.matrixMultiply(o,s),o=Q.WebGLUtil.matrixMultiply(o,i),Q.Mat3.inverse(o,t.transform.imat),o[2]=t.alpha,this.mstack.push(o)},Q.WebGLRender=h,o.prototype={getPosition:function(){},crossing:function(t){}},Q.Zone=o,Q.Util.inherits(a,Q.Zone),a.prototype.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},a.prototype.getDirection=function(t,e){var i=this.dy,r=-this.dx,s=this.dot,n=0==r?1:r;return(i*t+r*e+s)*n>0?!0:!1},a.prototype.getDistance=function(t,e){var i=this.dy,r=-this.dx,s=this.dot,n=i*t+r*e+s;return n/Math.sqrt(this.xxyy)},a.prototype.getSymmetric=function(t){var e=t.getGradient(),i=this.getGradient(),r=2*(i-e),s=t.x,n=t.y;return t.x=s*Math.cos(r)-n*Math.sin(r),t.y=s*Math.sin(r)+n*Math.cos(r),t},a.prototype.getGradient=function(){return Math.atan2(this.dy,this.dx)},a.prototype.getRange=function(t,e){var i=Math.abs(this.getGradient());i<=Math.PI/4?t.p.x<this.maxx&&t.p.x>this.minx&&e():t.p.y<this.maxy&&t.p.y>this.miny&&e()},a.prototype.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},a.prototype.crossing=function(t){var e=this;"dead"==this.crossType?">"==this.direction||"R"==this.direction||"right"==this.direction||"down"==this.direction?this.getRange(t,function(){e.getDirection(t.p.x,t.p.y)&&(t.dead=!0)}):this.getRange(t,function(){e.getDirection(t.p.x,t.p.y)||(t.dead=!0)}):"bound"==this.crossType?this.getRange(t,function(){e.getDistance(t.p.x,t.p.y)<=t.radius&&(0==e.dx?t.v.x*=-1:0==e.dy?t.v.y*=-1:e.getSymmetric(t.v))}):"cross"==this.crossType&&this.alert&&(alert("Sorry lineZone does not support cross method"),this.alert=!1)},Q.LineZone=a,Q.Util.inherits(n,Q.Zone),n.prototype.getPosition=function(){return this.random=Math.random(),this.angle=2*Math.PI*Math.random(),this.vector.x=this.x+this.random*this.radius*Math.cos(this.angle),this.vector.y=this.y+this.random*this.radius*Math.sin(this.angle),this.vector},n.prototype.setCenter=function(t,e){this.center.x=t,this.center.y=e},n.prototype.crossing=function(t){var e=t.p.distanceTo(this.center);"dead"==this.crossType?e-t.radius>this.radius&&(t.dead=!0):"bound"==this.crossType?e+t.radius>=this.radius&&this.getSymmetric(t):"cross"==this.crossType&&this.alert&&(alert("Sorry CircleZone does not support cross method"),this.alert=!1)},n.prototype.getSymmetric=function(t){var e=t.v.getGradient(),i=this.getGradient(t),r=2*(i-e),s=t.v.x,n=t.v.y;t.v.x=s*Math.cos(r)-n*Math.sin(r),t.v.y=s*Math.sin(r)+n*Math.cos(r)},n.prototype.getGradient=function(t){return-Math.PI/2+Math.atan2(t.p.y-this.center.y,t.p.x-this.center.x)},Q.CircleZone=n,Q.Util.inherits(s,Q.Zone),s.prototype.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},s.prototype.crossing=function(t){this.alert&&(alert("Sorry PointZone does not support crossing method"),this.alert=!1)},Q.PointZone=s,Q.Util.inherits(r,Q.Zone),r.prototype.getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},r.prototype.crossing=function(t){"dead"==this.crossType?(t.p.x+t.radius<this.x?t.dead=!0:t.p.x-t.radius>this.x+this.width&&(t.dead=!0),t.p.y+t.radius<this.y?t.dead=!0:t.p.y-t.radius>this.y+this.height&&(t.dead=!0)):"bound"==this.crossType?(t.p.x-t.radius<this.x?(t.p.x=this.x+t.radius,t.v.x*=-1):t.p.x+t.radius>this.x+this.width&&(t.p.x=this.x+this.width-t.radius,t.v.x*=-1),t.p.y-t.radius<this.y?(t.p.y=this.y+t.radius,t.v.y*=-1):t.p.y+t.radius>this.y+this.height&&(t.p.y=this.y+this.height-t.radius,t.v.y*=-1)):"cross"==this.crossType&&(t.p.x+t.radius<this.x&&t.v.x<=0?t.p.x=this.x+this.width+t.radius:t.p.x-t.radius>this.x+this.width&&t.v.x>=0&&(t.p.x=this.x-t.radius),t.p.y+t.radius<this.y&&t.v.y<=0?t.p.y=this.y+this.height+t.radius:t.p.y-t.radius>this.y+this.height&&t.v.y>=0&&(t.p.y=this.y-t.radius))},Q.RectZone=r,Q.Util.inherits(i,Q.Zone),i.prototype.reset=function(t,e,i,r){this.imageData=t,this.x=Q.Util.initValue(e,0),this.y=Q.Util.initValue(i,0),this.d=Q.Util.initValue(r,2),this.vectors=[],this.setVectors()},i.prototype.setVectors=function(){var t,e,i=this.imageData.width,r=this.imageData.height;for(t=0;i>t;t+=this.d)for(e=0;r>e;e+=this.d){var s=4*((e>>0)*i+(t>>0));this.imageData.data[s+3]>0&&this.vectors.push({x:t+this.x,y:e+this.y})}return this.vector},i.prototype.getBound=function(t,e){var i=4*((e>>0)*this.imageData.width+(t>>0));return this.imageData.data[i+3]>0?!0:!1},i.prototype.getPosition=function(){return this.vector.copy(this.vectors[Math.floor(Math.random()*this.vectors.length)])},i.prototype.getColor=function(t,e){t-=this.x,e-=this.y;var i=4*((e>>0)*this.imageData.width+(t>>0));return{r:this.imageData.data[i],g:this.imageData.data[i+1],b:this.imageData.data[i+2],a:this.imageData.data[i+3]}},i.prototype.crossing=function(t){"dead"==this.crossType?this.getBound(t.p.x-this.x,t.p.y-this.y)?t.dead=!0:t.dead=!1:"bound"==this.crossType&&(this.getBound(t.p.x-this.x,t.p.y-this.y)||t.v.negate())},Q.ImageZone=i;var nt=function(){if(t.console&&t.console.log){var e=arguments;if("string"==typeof arguments[0])if(0==arguments[0].indexOf("+")){var i=parseInt(arguments[0]);nt.once<i&&(delete e[0],console.log(e),nt.once++)}else console.log(e);else console.log(e)}};nt.once=0,Q.log=nt;var at=at||{addEventListener:function(t,e){t.addEventListener(Q.PROTON_UPDATE,function(){e()})},setStyle:function(t){var e=t||"#ff0000",i=Q.Util.hexToRGB(e),r="rgba("+i.r+","+i.g+","+i.b+",0.5)";return r},drawZone:function(t,e,i,r){var s=e.getContext("2d"),n=this.setStyle();this.addEventListener(t,function(){r&&s.clearRect(0,0,e.width,e.height),i instanceof Q.PointZone?(s.beginPath(),s.fillStyle=n,s.arc(i.x,i.y,10,0,2*Math.PI,!0),s.fill(),s.closePath()):i instanceof Q.LineZone?(s.beginPath(),s.strokeStyle=n,s.moveTo(i.x1,i.y1),s.lineTo(i.x2,i.y2),s.stroke(),s.closePath()):i instanceof Q.RectZone?(s.beginPath(),s.strokeStyle=n,s.drawRect(i.x,i.y,i.width,i.height),s.stroke(),s.closePath()):i instanceof Q.CircleZone&&(s.beginPath(),s.strokeStyle=n,s.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),s.stroke(),s.closePath())})},drawEmitter:function(t,e,i,r){var s=e.getContext("2d"),n=this.setStyle();this.addEventListener(t,function(){r&&s.clearRect(0,0,e.width,e.height),s.beginPath(),s.fillStyle=n,s.arc(i.p.x,i.p.y,10,0,2*Math.PI,!0),s.fill(),s.closePath()})},test:{},setTest:function(t,e){this.test[t]=e},getTest:function(t){return this.test.hasOwnProperty(t)?this.test[t]:!1}};Q.Debug=at}(window),function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var r=(new Date).getTime(),s=Math.max(0,16-(r-t)),n=window.setTimeout(function(){e(r+s)},s);return t=r+s,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}()},{}],2:[function(t,e,i){"use strict";var r=t("./hakurei").core,s=t("./hakurei").util,n=t("./scene/stg"),a=function(t){r.apply(this,arguments),this.addScene("stg",new n(this))};s.inherit(a,r),a.prototype.init=function(){r.prototype.init.apply(this,arguments),this.changeScene("stg")},e.exports=a},{"./hakurei":3,"./scene/stg":16}],3:[function(t,e,i){"use strict";e.exports=t("./hakurejs/index")},{"./hakurejs/index":5}],4:[function(t,e,i){"use strict";var r=function(t){this.ctx=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.current_scene=null,this.scenes={},this.frame_count=0,this.request_id=null};r.prototype.init=function(){this.current_scene=null,this.frame_count=0,this.request_id=null},r.prototype.isRunning=function(){return this.request_id?!0:!1},r.prototype.startRun=function(){this.isRunning()||this.run()},r.prototype.run=function(){var t=this.currentScene();t&&(t.beforeDraw(),this.clearCanvas(),t.draw(),t.afterDraw()),this.frame_count++,this.request_id=requestAnimationFrame(this.run.bind(this))},r.prototype.currentScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},r.prototype.addScene=function(t,e){this.scenes[t]=e},r.prototype.changeScene=function(t){this.current_scene=t,this.currentScene().init()},r.prototype.clearCanvas=function(){this.ctx.clearRect(0,0,this.width,this.height)},e.exports=r},{}],5:[function(t,e,i){"use strict";e.exports={util:t("./util"),core:t("./core"),
scene:{base:t("./scene/base")},object:{base:t("./object/base"),pool_manager:t("./object/pool_manager")}}},{"./core":4,"./object/base":6,"./object/pool_manager":7,"./scene/base":8,"./util":9}],6:[function(t,e,i){"use strict";var r=function(t){this.scene=t,this.core=t.core,this.frame_count=0,this.x=0,this.y=0};r.prototype.init=function(){this.frame_count=0,this.x=0,this.y=0},r.prototype.beforeDraw=function(){this.frame_count++},r.prototype.draw=function(){},r.prototype.afterDraw=function(){},e.exports=r},{}],7:[function(t,e,i){"use strict";var r=t("./base"),s=t("../util"),n=function(t){r.apply(this,arguments),this.objects=[]};s.inherit(n,r),n.prototype.init=function(){r.prototype.init.apply(this,arguments),this.objects=[]},n.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments);for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw()},n.prototype.draw=function(){r.prototype.draw.apply(this,arguments);for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw()},n.prototype.afterDraw=function(){r.prototype.afterDraw.apply(this,arguments);for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},n.prototype.addObject=function(t){this.objects.push(t)},n.prototype.addObjects=function(t){this.objects=this.objects.concat(t)},e.exports=n},{"../util":9,"./base":6}],8:[function(t,e,i){"use strict";var r=function(t){this.core=t,this.frame_count=0,this.objects=[]};r.prototype.init=function(){this.frame_count=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},r.prototype.beforeDraw=function(){this.frame_count++;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw()},r.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw()},r.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},r.prototype.addObject=function(t){this.objects.push(t)},e.exports=r},{}],9:[function(t,e,i){"use strict";var r={inherit:function(t,e){var i=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=i(e.prototype),t.prototype.constructor=t},radianToTheta:function(t){return 180*t/Math.PI|0},thetaToRadian:function(t){return t*Math.PI/180},hexToRGBString:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t,i=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),s=parseInt(e.substring(4,6),16);return"rgb("+i+", "+r+", "+s+")"}};e.exports=r},{}],10:[function(t,e,i){"use strict";var r=function(){};r.prototype.init=function(){},r.prototype.update=function(){},r.prototype.is_occur=function(){},r.prototype.getAppearEnemies=function(){},e.exports=r},{}],11:[function(t,e,i){"use strict";var r=t("./game");window.AudioContext=window.AudioContext||window.webkitAudioContext;var s;window.onload=function(){var t=document.getElementById("mainCanvas");s=new r(t),s.init(),window.onkeydown=function(t){s.handleKeyDown(t)},window.onkeyup=function(t){s.handleKeyUp(t)},s.startRun()},window.onerror=function(t,e,i,r,s){window.alert(t+"\n"+i+":"+r)}},{"./game":2}],12:[function(t,e,i){"use strict";var r=t("../hakurei").object.base,s=t("../hakurei").util,n=function(t){r.apply(this,arguments)};s.inherit(n,r),n.prototype.init=function(){r.prototype.init.apply(this,arguments),this.x=30,this.y=30},n.prototype.draw=function(){var t=this.core.ctx;t.fillStyle="rgb( 6, 40, 255 )",t.textAlign="left",t.fillText("Frame: "+this.frame_count,this.x,this.y),r.prototype.draw.apply(this,arguments)},e.exports=n},{"../hakurei":3}],13:[function(t,e,i){"use strict";var r=t("../../hakurei").object.base,s=t("../../hakurei").util,n=t("../../proton"),a=function(t){r.apply(this,arguments),this.canvas=document.createElement("canvas")};s.inherit(a,r),a.prototype.init=function(){r.prototype.init.apply(this,arguments),this.proton=this.createProton()},a.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.proton.update()},a.prototype.draw=function(){r.prototype.draw.apply(this,arguments),this.core.ctx.drawImage(this.canvas,this.x,this.y)},a.prototype.createProton=function(){var t=new n;return t},e.exports=a},{"../../hakurei":3,"../../proton":15}],14:[function(t,e,i){"use strict";var r=t("./base"),s=t("../../hakurei").util,n=t("../../proton"),a=function(t){r.apply(this,arguments),this.canvas.width=1003,this.canvas.height=610};s.inherit(a,r),a.prototype.createProton=function(){var t=this.canvas,e=["#529B88","#CDD180","#FFFA32","#FB6255","#FB4A53","#FF4E50","#F9D423"],i=new n,r=new n.Emitter;r.rate=new n.Rate(new n.Span(3,6),new n.Span(.05,.2)),r.addInitialize(new n.Mass(1)),r.addInitialize(new n.Radius(20,200)),r.addInitialize(new n.Life(2,4)),r.addInitialize(new n.Position(new n.RectZone(0,0,t.width,t.height))),r.addBehaviour(new n.Alpha(0,1,1/0,n.easeOutCubic)),r.addBehaviour(new n.Scale(1,0,1/0,n.easeOutCubic)),r.addBehaviour(new n.Color(e,"random")),r.emit(),i.addEmitter(r);var s=new n.Renderer("canvas",i,t);return s.start(),i},e.exports=a},{"../../hakurei":3,"../../proton":15,"./base":13}],15:[function(t,e,i){"use strict";t("proton");var r=window.Proton;e.exports=r},{proton:1}],16:[function(t,e,i){"use strict";var r=t("../hakurei").scene.base,s=t("../hakurei").util,n=t("../hakurei").object.pool_manager,a=t("../object/chara"),o=t("../object/particle/enemy_appear"),h=t("../logic/enemy_appear"),u=function(t){r.apply(this,arguments),this.chara=new a(this),this.addObject(this.chara),this.enemies=new n(this),this.addObject(this.enemies),this.enemy_appear=new h,this.addObject(new o(this))};s.inherit(u,r),u.prototype.init=function(){r.prototype.init.apply(this,arguments),this.enemy_appear.init()},u.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.enemy_appear.update(),this.enemy_appear.is_occur()&&this.enemies.addObjects(this.enemy_appear.getAppearEnemies())},u.prototype.draw=function(){var t=this.core.ctx;t.fillStyle=s.hexToRGBString("E2FFFC"),t.fillRect(0,0,this.core.width,this.core.height),r.prototype.draw.apply(this,arguments)},e.exports=u},{"../hakurei":3,"../logic/enemy_appear":10,"../object/chara":12,"../object/particle/enemy_appear":14}]},{},[11]);