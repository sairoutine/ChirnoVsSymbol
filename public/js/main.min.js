!function t(e,i,o){function r(s,a){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(n)return n(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=i[s]={exports:{}};e[s][0].call(p.exports,function(t){var i=e[s][1][t];return r(i?i:t)},p,p.exports,t,e,i,o)}return i[s].exports}for(var n="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(t,e,i){"use strict";var o=t("./hakurei").core,r=t("./hakurei").util,n=t("./scene/stg"),s=t("./scene/loading"),a=function(t){o.apply(this,arguments),this.addScene("stg",new n(this)),this.addScene("loading",new s(this))};r.inherit(a,o),a.prototype.init=function(){o.prototype.init.apply(this,arguments),this.changeScene("loading")},e.exports=a},{"./hakurei":2,"./scene/loading":17,"./scene/stg":18}],2:[function(t,e,i){"use strict";e.exports=t("./hakurejs/index")},{"./hakurejs/index":6}],3:[function(t,e,i){"use strict";var o=function(t){this.images={},this.loading_image_num=0,this.loaded_image_num=0};o.prototype.init=function(){for(var t in this.images)this.images[t].src="";this.images={},this.loading_image_num=0,this.loaded_image_num=0},o.prototype.loadImage=function(t,e){var i=this;i.loading_image_num++;var o=function(){i.loaded_image_num++},r=new Image;r.src=e,r.onload=o,this.images[t]=r},o.prototype.isAllLoaded=function(){return this.loaded_image_num>0&&this.loaded_image_num===this.loading_image_num},o.prototype.getImage=function(t){return this.images[t]},e.exports=o},{}],4:[function(t,e,i){"use strict";var o={BUTTON_SHIFT:16,BUTTON_SPACE:32,BUTTON_LEFT:37,BUTTON_UP:38,BUTTON_RIGHT:39,BUTTON_DOWN:40,BUTTON_X:88,BUTTON_Z:90};e.exports=o},{}],5:[function(t,e,i){"use strict";var o=t("./constant"),r=t("./asset_loader/image"),n=function(t){this.ctx=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.current_scene=null,this.scenes={},this.frame_count=0,this.request_id=null,this.key_down_map={},this.image_loader=new r};n.prototype.init=function(){this.current_scene=null,this.frame_count=0,this.request_id=null,this.key_down_map={},this.image_loader.init()},n.prototype.isRunning=function(){return this.request_id?!0:!1},n.prototype.startRun=function(){this.isRunning()||this.run()},n.prototype.run=function(){this.handleGamePad();var t=this.currentScene();t&&(t.beforeDraw(),this.clearCanvas(),t.draw(),t.afterDraw()),this.frame_count++,this.request_id=requestAnimationFrame(this.run.bind(this))},n.prototype.currentScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},n.prototype.addScene=function(t,e){this.scenes[t]=e},n.prototype.changeScene=function(t){this.current_scene=t,this.currentScene().init()},n.prototype.clearCanvas=function(){this.ctx.clearRect(0,0,this.width,this.height)},n.prototype.handleKeyDown=function(t){var e=t.keyCode;e in this.key_down_map||(this.key_down_map[e]=0),this.key_down_map[e]++,t.preventDefault()},n.prototype.handleKeyUp=function(t){this.key_down_map[t.keyCode]=0,t.preventDefault()},n.prototype.handleGamePad=function(){var t=navigator.getGamepads(),e=t[0];if(e){for(var i=[o.BUTTON_Z,o.BUTTON_X],r=0,n=i.length;n>r;r++)e.buttons[r].pressed?(i[r]in this.key_down_map||(this.key_down_map[i[r]]=0),this.key_down_map[i[r]]++):this.key_down_map[i[r]]=0;e.axes[1]<-.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_UP]=0),this.key_down_map[o.BUTTON_UP]++):this.key_down_map[o.BUTTON_UP]=0,e.axes[1]>.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_DOWN]=0),this.key_down_map[o.BUTTON_DOWN]++):this.key_down_map[o.BUTTON_DOWN]=0,e.axes[0]<-.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_LEFT]=0),this.key_down_map[o.BUTTON_LEFT]++):this.key_down_map[o.BUTTON_LEFT]=0,e.axes[0]>.5?(o.BUTTON_UP in this.key_down_map||(this.key_down_map[o.BUTTON_RIGHT]=0),this.key_down_map[o.BUTTON_RIGHT]++):this.key_down_map[o.BUTTON_RIGHT]=0}},n.prototype.isKeyDown=function(t){return this.key_down_map[t]>0?!0:!1},n.prototype.isKeyPush=function(t){return 1===this.key_down_map[t]?!0:!1},e.exports=n},{"./asset_loader/image":3,"./constant":4}],6:[function(t,e,i){"use strict";e.exports={util:t("./util"),core:t("./core"),constant:t("./constant"),scene:{base:t("./scene/base")},object:{base:t("./object/base"),sprite:t("./object/sprite"),pool_manager:t("./object/pool_manager")},asset_loader:{image:t("./asset_loader/image")}}},{"./asset_loader/image":3,"./constant":4,"./core":5,"./object/base":7,"./object/pool_manager":8,"./object/sprite":9,"./scene/base":10,"./util":11}],7:[function(t,e,i){"use strict";var o=t("../util"),r=0,n=function(t){this.scene=t,this.core=t.core,this.id=++r,this.frame_count=0,this.x=0,this.y=0,this.velocity={magnitude:0,theta:0}};n.prototype.init=function(){this.frame_count=0,this.x=0,this.y=0},n.prototype.beforeDraw=function(){this.frame_count++,this.move()},n.prototype.draw=function(){},n.prototype.afterDraw=function(){},n.prototype.move=function(){var t=o.calcMoveXByVelocity(this.velocity),e=o.calcMoveYByVelocity(this.velocity);this.x+=t,this.y+=e},n.prototype.width=function(){return 0},n.prototype.height=function(){return 0},n.prototype.globalCenterX=function(){return this.scene.x+this.x},n.prototype.globalCenterY=function(){return this.scene.y+this.y},n.prototype.globalLeftX=function(){return this.scene.x+this.x-this.width()/2},n.prototype.globalRightX=function(){return this.scene.x+this.x+this.width()/2},n.prototype.globalUpY=function(){return this.scene.x+this.y-this.height()/2},n.prototype.globalDownY=function(){return this.scene.x+this.y+this.height()/2},n.prototype.setVelocity=function(t){this.velocity=t},e.exports=n},{"../util":11}],8:[function(t,e,i){"use strict";var o=t("./base"),r=t("../util"),n=function(t,e){o.apply(this,arguments),this.Class=e,this.objects={}};r.inherit(n,o),n.prototype.init=function(){o.prototype.init.apply(this,arguments),this.objects={}},n.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].beforeDraw()},n.prototype.draw=function(){o.prototype.draw.apply(this,arguments);for(var t in this.objects)this.objects[t].draw()},n.prototype.afterDraw=function(){o.prototype.afterDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].afterDraw()},n.prototype.create=function(){var t=new this.Class(this.scene);return t.init.apply(t,arguments),this.objects[t.id]=t,t},e.exports=n},{"../util":11,"./base":7}],9:[function(t,e,i){"use strict";var o=t("./base"),r=t("../util"),n=function(t){o.apply(this,arguments),this.current_sprite_index=0};r.inherit(n,o),n.prototype.init=function(){o.prototype.init.apply(this,arguments),this.current_sprite_index=0},n.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments),this.frame_count%this.spriteAnimationSpan()===0&&(this.current_sprite_index++,this.current_sprite_index>=this.spriteIndices().length&&(this.current_sprite_index=0))},n.prototype.draw=function(){o.prototype.draw.apply(this,arguments);var t=this.core.image_loader.getImage(this.spriteName()),e=this.core.ctx;e.save(),e.translate(this.globalCenterX(),this.globalCenterY());var i=r.thetaToRadian(this.velocity.theta+this.rotateAdjust());e.rotate(i);var n=this.spriteWidth(),s=this.spriteHeight();n||(n=t.width),s||(s=t.height);var a=n*this.scale(),h=s*this.scale();e.drawImage(t,n*this.spriteIndexX(),s*this.spriteIndexY(),n,s,-a/2,-h/2,a,h),e.restore()},n.prototype.spriteName=function(){throw new Error("spriteName method must be overridden.")},n.prototype.spriteIndexX=function(){return this.spriteIndices()[this.current_sprite_index].x},n.prototype.spriteIndexY=function(){return this.spriteIndices()[this.current_sprite_index].y},n.prototype.spriteAnimationSpan=function(){return 0},n.prototype.spriteIndices=function(){return[{x:0,y:0}]},n.prototype.spriteWidth=function(){return 0},n.prototype.spriteHeight=function(){return 0},n.prototype.rotateAdjust=function(){return 0},n.prototype.scale=function(){return 1},e.exports=n},{"../util":11,"./base":7}],10:[function(t,e,i){"use strict";var o=function(t){this.core=t,this.width=t.width,this.height=t.height,this.x=0,this.y=0,this.frame_count=0,this.objects=[]};o.prototype.init=function(){this.x=0,this.y=0,this.frame_count=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},o.prototype.beforeDraw=function(){this.frame_count++;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw()},o.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw()},o.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},o.prototype.addObject=function(t){this.objects.push(t)},e.exports=o},{}],11:[function(t,e,i){"use strict";var o={inherit:function(t,e){var i=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=i(e.prototype),t.prototype.constructor=t},radianToTheta:function(t){return 180*t/Math.PI|0},thetaToRadian:function(t){return t*Math.PI/180},calcMoveXByVelocity:function(t){return t.magnitude*Math.cos(o.thetaToRadian(t.theta))},calcMoveYByVelocity:function(t){return t.magnitude*Math.sin(o.thetaToRadian(t.theta))},hexToRGBString:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t,i=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return"rgb("+i+", "+o+", "+r+")"}};e.exports=o},{}],12:[function(t,e,i){"use strict";var o=function(t){this.enemies=t.enemies,this.chara=t.chara,this.scene=t,this.frame_count=0};o.prototype.init=function(){this.frame_count=0},o.prototype.exec=function(){this.update(),this.is_occur()&&this.create()},o.prototype.update=function(){this.frame_count++},o.prototype.is_occur=function(){return this.frame_count%20===0},o.prototype.create=function(){for(var t=Math.floor(5*Math.random()+1),e=Math.floor(50*Math.random()),i=0;3>i;i++){var o=Math.floor(Math.random()*this.chara.x+100),r=Math.floor(Math.random()*this.chara.y+100);this.enemies.create(o,r,t,e)}},e.exports=o},{}],13:[function(t,e,i){"use strict";var o=t("./game");window.AudioContext=window.AudioContext||window.webkitAudioContext;var r;window.onload=function(){var t=document.getElementById("mainCanvas");r=new o(t),r.init(),window.onkeydown=function(t){r.handleKeyDown(t)},window.onkeyup=function(t){r.handleKeyUp(t)},r.startRun()},window.onerror=function(t,e,i,o,r){window.alert(t+"\n"+i+":"+o)}},{"./game":1}],14:[function(t,e,i){"use strict";var o=t("../hakurei").object.sprite,r=t("../hakurei").util,n=t("../hakurei").constant,s=6,a=function(t){o.apply(this,arguments),this.velocity={theta:0,magnitude:10}};r.inherit(a,o),a.prototype.init=function(){o.prototype.init.apply(this,arguments),this.x=this.scene.width/2,this.y=this.scene.height/2};var h=315,c=225,p=45,u=135,y=270,l=90,f=180,d=0;a.prototype.beforeDraw=function(){if(o.prototype.beforeDraw.apply(this,arguments),this.core.isKeyDown(n.BUTTON_LEFT)&&this.core.isKeyDown(n.BUTTON_DOWN)?this.velocity.theta=u:this.core.isKeyDown(n.BUTTON_RIGHT)&&this.core.isKeyDown(n.BUTTON_DOWN)?this.velocity.theta=p:this.core.isKeyDown(n.BUTTON_LEFT)&&this.core.isKeyDown(n.BUTTON_UP)?this.velocity.theta=c:this.core.isKeyDown(n.BUTTON_RIGHT)&&this.core.isKeyDown(n.BUTTON_UP)?this.velocity.theta=h:this.core.isKeyDown(n.BUTTON_UP)?this.velocity.theta=y:this.core.isKeyDown(n.BUTTON_DOWN)?this.velocity.theta=l:this.core.isKeyDown(n.BUTTON_LEFT)?this.velocity.theta=f:this.core.isKeyDown(n.BUTTON_RIGHT)&&(this.velocity.theta=d),this.frame_count%s===0){var t=15,e=15,i=this.velocity.theta;this.scene.shots.create(this.x,this.y,e,i),this.scene.shots.create(this.x,this.y,e,i).moveByVelocity({magnitude:t,theta:i+90}),this.scene.shots.create(this.x,this.y,e,i).moveByVelocity({magnitude:t,theta:i-90})}},a.prototype.move=function(){this.core.isKeyDown(n.BUTTON_Z)&&o.prototype.move.apply(this,arguments)},a.prototype.spriteName=function(){return"chara"},a.prototype.spriteIndices=function(){return[{x:4,y:0},{x:5,y:0}]},a.prototype.spriteAnimationSpan=function(){return 6},a.prototype.spriteWidth=function(){return 80},a.prototype.spriteHeight=function(){return 96},e.exports=a},{"../hakurei":2}],15:[function(t,e,i){"use strict";var o=t("../hakurei").object.base,r=t("../hakurei").util,n=function(t){o.apply(this,arguments)};r.inherit(n,o),n.prototype.init=function(t,e,i,r){o.prototype.init.apply(this,arguments);var n=["BCB6FF","B8E1FF","94FBAB","82ABA1"],s=Math.floor(Math.random()*n.length);this.color=n[s],this.type=Math.floor(3*Math.random()),this.x=t,this.y=e,this.setVelocity({magnitude:i,theta:0})},n.prototype.draw=function(){switch(o.prototype.draw.apply(this,arguments),this.type){case 0:this.drawBox();break;case 1:this.drawTriangle();break;case 2:this.drawCircle();break;default:throw new Error("unknown enemy type")}},n.prototype.drawBox=function(){var t=this.core.ctx,e=20;t.save(),t.fillStyle=r.hexToRGBString(this.color),t.translate(this.globalCenterX(),this.globalCenterY()),t.fillRect(0,0,e,e),t.restore()},n.prototype.drawTriangle=function(){var t=this.core.ctx;t.save(),t.fillStyle=r.hexToRGBString(this.color),t.translate(this.globalCenterX(),this.globalCenterY()),t.beginPath(),t.moveTo(75,50),t.lineTo(100,75),t.lineTo(100,25),t.fill(),t.restore()},n.prototype.drawCircle=function(){var t=this.core.ctx,e=20;t.save(),t.fillStyle=r.hexToRGBString(this.color),t.beginPath(),t.arc(this.globalCenterX(),this.globalCenterY(),e,0,2*Math.PI,!0),t.fill(),t.restore()},e.exports=n},{"../hakurei":2}],16:[function(t,e,i){"use strict";var o=t("../hakurei").object.sprite,r=t("../hakurei").util,n=function(t){o.apply(this,arguments)};r.inherit(n,o),n.prototype.init=function(t,e,i,r){o.prototype.init.apply(this,arguments),this.x=t,this.y=e,this.setVelocity({magnitude:i,theta:r})},n.prototype.moveByVelocity=function(t){var e=r.calcMoveXByVelocity(t),i=r.calcMoveYByVelocity(t);this.x+=e,this.y+=i},n.prototype.spriteName=function(){return"shot"},n.prototype.spriteIndices=function(){return[{x:5,y:13}]},n.prototype.spriteWidth=function(){return 18},n.prototype.spriteHeight=function(){return 16},n.prototype.rotateAdjust=function(){return 90},e.exports=n},{"../hakurei":2}],17:[function(t,e,i){"use strict";var o=t("../hakurei").scene.base,r=t("../hakurei").util,n=function(t){o.apply(this,arguments)};r.inherit(n,o),n.prototype.init=function(){o.prototype.init.apply(this,arguments),this.core.image_loader.loadImage("chara","./image/chirno.png"),this.core.image_loader.loadImage("shot","./image/shot.png")},n.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments),this.core.image_loader.isAllLoaded()&&this.core.changeScene("stg")},n.prototype.draw=function(){o.prototype.draw.apply(this,arguments);var t=this.core.ctx;t.save(),t.fillStyle="rgb( 0, 0, 0 )",t.textAlign="right",t.font="30px 'ＭＳ ゴシック'",t.fillText("Now Loading...",400,225),t.restore()},e.exports=n},{"../hakurei":2}],18:[function(t,e,i){"use strict";var o=t("../hakurei").scene.base,r=t("../hakurei").util,n=t("../hakurei").object.pool_manager,s=t("../hakurei").constant,a=t("../object/chara"),h=t("../object/enemy"),c=t("../object/shot"),p=t("../logic/enemy_appear"),u=function(t){o.apply(this,arguments),this.width=1500,this.height=1500,this.shots=new n(this,c),this.addObject(this.shots),this.chara=new a(this),this.addObject(this.chara),this.enemies=new n(this,h),this.addObject(this.enemies),this.enemy_appear=new p(this)};r.inherit(u,o),u.prototype.init=function(){o.prototype.init.apply(this,arguments),this.enemy_appear.init(),this.x=-this.chara.x+this.core.width/2,this.y=-this.chara.y+this.core.height/2},u.prototype.beforeDraw=function(){o.prototype.beforeDraw.apply(this,arguments),this.enemy_appear.exec(),this.core.isKeyDown(s.BUTTON_Z)&&(this.chara.x<0?this.chara.x=0:this.chara.x>this.width&&(this.chara.x=this.width),this.chara.y<0?this.chara.y=0:this.chara.y>this.height&&(this.chara.y=this.height),this.x=-this.chara.x+this.core.width/2,this.y=-this.chara.y+this.core.height/2)},u.prototype.draw=function(){var t=this.core.ctx;t.fillStyle=r.hexToRGBString("E2FFFC"),t.fillRect(0,0,this.width,this.height);var e=10;t.fillStyle=r.hexToRGBString("608C87"),t.fillRect(this.x,this.y,e,this.height),t.fillRect(this.x+e,this.y,this.width,e),t.fillRect(this.x+this.width,this.y+e,e,this.height),t.fillRect(this.x,this.y+this.height,this.width,e),o.prototype.draw.apply(this,arguments)},e.exports=u},{"../hakurei":2,"../logic/enemy_appear":12,"../object/chara":14,"../object/enemy":15,"../object/shot":16}]},{},[13]);